{"entries":[{"timestamp":1762419155205,"editorVersion":"8.1.5","changes":[{"type":"edited","filename":"main.blocks","patch":[{"start1":0,"length1":133,"diffs":[[1,"<xml xmlns=\"http://www.w3.org/1999/xhtml\">\n  <block type=\"pxt-on-start\"></block>\n  <block type=\"device_forever\"></block>\n</xml>"]]}]},{"type":"edited","filename":"main.ts","patch":[{"start1":0,"length1":33,"diffs":[[1,"\n"]]}]},{"type":"edited","filename":"pxt.json","patch":[{"start1":69,"length1":39,"diffs":[[1,"        \"core\": \"*\"\n"]]},{"start1":153,"length1":41,"diffs":[[1,"        \"README.md\"\n"]]},{"start1":180,"length1":31,"diffs":[[1,"    \"additionalFilePaths\": []\n"]]}]},{"type":"added","filename":"custom.ts","value":"\n/**\n* Nutze diese Datei für benutzerdefinierte Funktionen und Blöcke.\n* Weitere Informationen unter https://makecode.calliope.cc/blocks/custom\n*/\n\nenum MyEnum {\n    //% block=\"one\"\n    One,\n    //% block=\"two\"\n    Two\n}\n\nlet isWifiConnected = false;\n\n/**\n* Functions for Wifi8285 module.\n*/\n//% block\n//% weight=10 color=#606060 icon=\"\\uf1eb\" block=\"Wifi8285\"\nnamespace UART_WiFi_V2 {\n    \n        export function setupWifi(txPin: SerialPin, rxPin: SerialPin, baudRate: BaudRate, ssid: string, passwd: string) {\n        let result = 0;\n\n        isWifiConnected = false;\n\n        serial.redirect(\n            txPin,\n            rxPin,\n            baudRate\n        )\n\n        sendAtCmd(\"AT\")\n        result = waitAtResponse(\"OK\", \"ERROR\", \"None\", 1000)\n\n        sendAtCmd(\"AT+CWMODE=1\")\n        result = waitAtResponse(\"OK\", \"ERROR\", \"None\", 1000)\n\n        sendAtCmd(`AT+CWJAP=\"${ssid}\",\"${passwd}\"`)\n        result = waitAtResponse(\"WIFI GOT IP\", \"ERROR\", \"None\", 20000)\n\n        if (result == 1) {\n            isWifiConnected = true\n        }\n    }\n\n    function waitAtResponse(target1: string, target2: string, target3: string, timeout: number) {\n        let buffer = \"\"\n        let start = input.runningTime()\n\n        while ((input.runningTime() - start) < timeout) {\n            buffer += serial.readString()\n\n            if (buffer.includes(target1)) return 1\n            if (buffer.includes(target2)) return 2\n            if (buffer.includes(target3)) return 3\n\n            basic.pause(100)\n        }\n\n            return 0\n        }\n\n        function sendAtCmd(cmd: string) {\n            serial.writeString(cmd + \"\\u000D\\u000A\")\n        }\n    \n    \n    \n    /**\n     * TODO: describe your function here\n     * @param n describe parameter here, eg: 5\n     * @param s describe parameter here, eg: \"Hello\"\n     * @param e describe parameter here\n     */\n    //% block\n    export function foo(n: number, s: string, e: MyEnum): void {\n         //Add code here\n    }\n\n    /**\n     * TODO: describe your function here\n     * @param value describe value here, eg: 5\n     */\n    //% block\n    //export function fib(value: number): number {\n      //return value <= 1 ? value : fib(value -1) + fib(value - 2);\n    //}\n}\n"}]},{"timestamp":1762419768952,"editorVersion":"8.1.5","changes":[{"type":"edited","filename":"custom.ts","patch":[{"start1":252,"length1":4,"diffs":[[1,""]]}]}]},{"timestamp":1762419793103,"editorVersion":"8.1.5","changes":[{"type":"edited","filename":"main.blocks","patch":[{"start1":0,"length1":534,"diffs":[[1,"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables></variables><block type=\"device_forever\" x=\"0\" y=\"0\"></block></xml>"]]}]},{"type":"edited","filename":"main.ts","patch":[{"start1":28,"length1":130,"diffs":[[1,"\t\n"]]}]},{"type":"edited","filename":"custom.ts","patch":[{"start1":148,"length1":0,"diffs":[[1,"enum MyEnum {\n    //% block=\"one\"\n    One,\n    //% block=\"two\"\n    Two\n}\n\n"]]},{"start1":252,"length1":0,"diffs":[[1,"\n\n\n\n"]]},{"start1":260,"length1":38,"diffs":[[1,"* Functions for Wifi8285 module.\n*/\n//% block\n"]]},{"start1":365,"length1":1,"diffs":[[1,""]]},{"start1":390,"length1":388,"diffs":[[1,"    \n"]]},{"start1":1054,"length1":450,"diffs":[[1,""]]},{"start1":1055,"length1":184,"diffs":[[1,""]]},{"start1":1655,"length1":0,"diffs":[[1,"    \n    \n    /**\n     * TODO: describe your function here\n     * @param n describe parameter here, eg: 5\n     * @param s describe parameter here, eg: \"Hello\"\n     * @param e describe parameter here\n     */\n    //% block\n    export function foo(n: number, s: string, e: MyEnum): void {\n         //Add code here\n    }\n\n    /**\n     * TODO: describe your function here\n     * @param value describe value here, eg: 5\n     */\n    //% block\n    //export function fib(value: number): number {\n      //return value <= 1 ? value : fib(value -1) + fib(value - 2);\n    //}\n"]]}]}]},{"timestamp":1762420379123,"editorVersion":"8.1.5","changes":[{"type":"edited","filename":"main.blocks","patch":[{"start1":0,"length1":868,"diffs":[[1,"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables></variables><block type=\"device_forever\" x=\"0\" y=\"0\"><statement name=\"HANDLER\"><block type=\"UART_WiFi_V2_setupWifi\"><field name=\"txPin\">SerialPin.C17</field><field name=\"rxPin\">SerialPin.C16</field><field name=\"baudrate\">BaudRate.BaudRate115200</field><value name=\"ssid\"><shadow type=\"text\"><field name=\"TEXT\">BBST1</field></shadow></value><value name=\"passwd\"><shadow type=\"text\"><field name=\"TEXT\">123456789</field></shadow></value></block></statement></block></xml>"]]}]},{"type":"edited","filename":"main.ts","patch":[{"start1":158,"length1":118,"diffs":[[1,""]]}]},{"type":"edited","filename":"custom.ts","patch":[{"start1":1406,"length1":140,"diffs":[[1,"    //% block=\"setup Wifi|TX %txPin|RX %rxPin|baudrate %baudrate|ssid = %ssid|password = %passwd\"\n    //% txPin.defl=SerialPin.C17\n"]]},{"start1":1674,"length1":117,"diffs":[[1,"    export function sendData(txPin: SerialPin, rxPin: SerialPin, baudRate: BaudRate, ssid: string, passwd: string) {\n"]]}]}]},{"timestamp":1762420955169,"editorVersion":"8.1.5","changes":[{"type":"edited","filename":"main.blocks","patch":[{"start1":0,"length1":536,"diffs":[[1,"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables></variables><block type=\"device_forever\" x=\"0\" y=\"0\"><statement name=\"HANDLER\"><block type=\"UART_WiFi_V2_setupWifi\"><field name=\"txPin\">SerialPin.C17</field><field name=\"rxPin\">SerialPin.C16</field><field name=\"baudrate\">BaudRate.BaudRate115200</field><value name=\"ssid\"><shadow type=\"text\"><field name=\"TEXT\">BBST1</field></shadow></value><value name=\"passwd\"><shadow type=\"text\"><field name=\"TEXT\">123456789</field></shadow></value><next><block type=\"UART_WiFi_V2_sendData\"><field name=\"rxPin\">SerialPin.C16</field><field name=\"baudrate\">BaudRate.BaudRate115200</field><value name=\"ssid\"><shadow type=\"text\"><field name=\"TEXT\">BBST1</field></shadow></value><value name=\"passwd\"><shadow type=\"text\"><field name=\"TEXT\">123456789</field></shadow></value></block></next></block></statement></block></xml>"]]}]},{"type":"edited","filename":"main.ts","patch":[{"start1":158,"length1":0,"diffs":[[1,"    UART_WiFi_V2.sendData(\n    \"\",\n    SerialPin.C16,\n    BaudRate.BaudRate115200,\n    \"BBST1\",\n    \"123456789\"\n    )\n"]]}]},{"type":"edited","filename":"custom.ts","patch":[{"start1":148,"length1":92,"diffs":[[1,""]]},{"start1":1406,"length1":116,"diffs":[[1,"    //% block=\"Daten senden|protocol = %protocol |RX %rxPin|baudrate %baudrate|ssid = %ssid|password = %passwd\"\n    //% protocol.defl=\"UDP\"\n"]]},{"start1":1651,"length1":111,"diffs":[[1,"    //% passwd.defl=\"123456789\"\n    export function sendData(protocol: string, rxPin: SerialPin, baudRate: BaudRate, ssid: string, passwd: string) {\n    \n"]]}]}]},{"timestamp":1762421553146,"editorVersion":"8.1.5","changes":[{"type":"edited","filename":"main.blocks","patch":[{"start1":0,"length1":534,"diffs":[[1,"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables></variables><block type=\"device_forever\" x=\"40\" y=\"54\"><statement name=\"HANDLER\"><block type=\"UART_WiFi_V2_setupWifi\"><field name=\"txPin\">SerialPin.C17</field><field name=\"rxPin\">SerialPin.C16</field><field name=\"baudrate\">BaudRate.BaudRate115200</field><value name=\"ssid\"><shadow type=\"text\"><field name=\"TEXT\">BBST1</field></shadow></value><value name=\"passwd\"><shadow type=\"text\"><field name=\"TEXT\">123456789</field></shadow></value></block></statement></block></xml>"]]}]},{"type":"edited","filename":"custom.ts","patch":[{"start1":1498,"length1":76,"diffs":[[1,"    //% block=\"Daten senden|Protokoll = %protocol|Port %port|Passwort = %passwd\"\n"]]},{"start1":1614,"length1":50,"diffs":[[1,"    //% rxPin.defl=SerialPin.C16\n    //% baudRate.defl=BaudRate.BaudRate115200\n    //% ssid.defl=\"BBST1\"\n//% passwd.defl=\"123456789\"\n"]]}]}]},{"timestamp":1762421751809,"editorVersion":"8.1.5","changes":[{"type":"edited","filename":"pxt.json","patch":[{"start1":220,"length1":35,"diffs":[[1,"    \"preferredEditor\": \"tsprj\"\n"]]}]}]},{"timestamp":1762422925992,"editorVersion":"8.1.5","changes":[{"type":"edited","filename":"main.ts","patch":[{"start1":158,"length1":53,"diffs":[[1,""]]}]}]},{"timestamp":1762423113846,"editorVersion":"8.1.5","changes":[{"type":"edited","filename":"main.ts","patch":[{"start1":158,"length1":0,"diffs":[[1,"    UART_WiFi_V2.sendData(Protocol.UDP, \"68492\", \"\")\n"]]}]},{"type":"edited","filename":"custom.ts","patch":[{"start1":1498,"length1":78,"diffs":[[1,"    //% block=\"setup Wifi|Protokoll = %protocol|Port %port|Text = %message\"\n"]]}]}]},{"timestamp":1762423366212,"editorVersion":"8.1.5","changes":[{"type":"edited","filename":"pxt.json","patch":[{"start1":220,"length1":31,"diffs":[[1,"    \"preferredEditor\": \"blocksprj\"\n"]]}]}]},{"timestamp":1762425325233,"editorVersion":"8.1.5","changes":[{"type":"edited","filename":"custom.ts","patch":[{"start1":204,"length1":16,"diffs":[[1,"    UDP = \"UDP\",\n"]]}]}]},{"timestamp":1762425410490,"editorVersion":"8.1.5","changes":[{"type":"edited","filename":"custom.ts","patch":[{"start1":0,"length1":0,"diffs":[[1,"\n"]]},{"start1":148,"length1":52,"diffs":[[1,"// Definiere ein Enum für das Protokoll\n"]]},{"start1":204,"length1":17,"diffs":[[1,"    UDP = \"UDP,\n    TCP = \"TCP\"\n"]]},{"start1":370,"length1":0,"diffs":[[1,"\n"]]},{"start1":396,"length1":0,"diffs":[[1,"        /**\n        * Setup UART Wifi8285 to connect to  Wifi\n        */\n        //% weight=100\n        //% block=\"setup Wifi|TX %txPin|RX %rxPin|baudrate %baudrate|ssid = %ssid|password = %passwd\"\n        //% txPin.defl=SerialPin.C17\n        //% rxPin.defl=SerialPin.C16\n        //% baudRate.defl=BaudRate.BaudRate115200\n        //% ssid.defl=\"BBST1\"\n        //% passwd.defl=\"123456789\"\n        export function setupWifi(txPin: SerialPin, rxPin: SerialPin, baudRate: BaudRate, ssid: string, passwd: string) {\n        let result = 0;\n"]]},{"start1":931,"length1":520,"diffs":[[1,"        isWifiConnected = false;\n"]]},{"start1":965,"length1":48,"diffs":[[1,"        serial.redirect(\n            txPin,\n            rxPin,\n            baudRate\n        )\n"]]},{"start1":1443,"length1":78,"diffs":[[1,"    \n    /**\n    * sendData\n    */\n    //% weight=100\n    //% block=\"Daten senden|Protokoll = %protocol|Port %port|Text = %message\"\n"]]},{"start1":1610,"length1":258,"diffs":[[1,"    //% port.defl=\"68492\"\n    //% message.defl=\"\"\n    export function sendData(protocol: Protocol, port: string, message: string) {\n"]]},{"start1":1743,"length1":73,"diffs":[[1,"    }\n"]]},{"start1":1750,"length1":137,"diffs":[[1,""]]},{"start1":1751,"length1":165,"diffs":[[1,""]]},{"start1":1752,"length1":169,"diffs":[[1,""]]},{"start1":1753,"length1":39,"diffs":[[1,""]]},{"start1":1754,"length1":0,"diffs":[[1,"\n"]]},{"start1":1865,"length1":40,"diffs":[[1,"    export function wifiOK() {\n"]]},{"start1":1934,"length1":106,"diffs":[[1,"    function waitAtResponse(target1: string, target2: string, target3: string, timeout: number) {\n"]]},{"start1":2392,"length1":23,"diffs":[[1,"            return 0\n        }\n"]]},{"start1":2424,"length1":224,"diffs":[[1,"        function sendAtCmd(cmd: string) {\n            serial.writeString(cmd + \"\\u000D\\u000A\")\n        }\n    \n}\n"]]}]}]},{"timestamp":1762426009212,"editorVersion":"8.1.5","changes":[{"type":"edited","filename":"main.blocks","patch":[{"start1":0,"length1":902,"diffs":[[1,"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables></variables><block type=\"device_forever\" x=\"0\" y=\"0\"><statement name=\"HANDLER\"><block type=\"UART_WiFi_V2_setupWifi\"><field name=\"txPin\">SerialPin.C17</field><field name=\"rxPin\">SerialPin.C16</field><field name=\"baudrate\">BaudRate.BaudRate115200</field><value name=\"ssid\"><shadow type=\"text\"><field name=\"TEXT\">BBST1</field></shadow></value><value name=\"passwd\"><shadow type=\"text\"><field name=\"TEXT\">123456789</field></shadow></value></block></statement></block></xml>"]]}]},{"type":"edited","filename":"custom.ts","patch":[{"start1":1345,"length1":149,"diffs":[[1,"\n    //% protocol.fieldEditor=\"dropdown\"\n    //% protocol.fieldOptions=\"enum\"\n"]]},{"start1":1458,"length1":82,"diffs":[[1,"    //% block=\"Daten senden|Protokoll %protocol = \"UDP\"|IP %ip = 10.254.10.185 |Port %port = \"64982\"|Text %message\" = \"\"\n"]]}]}]},{"timestamp":1762426563329,"editorVersion":"8.1.5","changes":[{"type":"edited","filename":"main.blocks","patch":[{"start1":0,"length1":902,"diffs":[[1,"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables></variables><block type=\"device_forever\" x=\"0\" y=\"0\"><statement name=\"HANDLER\"><block type=\"UART_WiFi_V2_setupWifi\"><field name=\"txPin\">SerialPin.C17</field><field name=\"rxPin\">SerialPin.C16</field><field name=\"baudrate\">BaudRate.BaudRate115200</field><value name=\"ssid\"><shadow type=\"text\"><field name=\"TEXT\">BBST1</field></shadow></value><value name=\"passwd\"><shadow type=\"text\"><field name=\"TEXT\">123456789</field></shadow></value><next><block type=\"UART_WiFi_V2_sendData\"><field name=\"protocol\">Protocol.TCP</field><value name=\"ip\"><shadow type=\"text\"><field name=\"TEXT\">10.254.10.185</field></shadow></value><value name=\"port\"><shadow type=\"text\"><field name=\"TEXT\">69824</field></shadow></value><value name=\"message\"><shadow type=\"text\"><field name=\"TEXT\"></field></shadow></value></block></next></block></statement></block></xml>"]]}]},{"type":"edited","filename":"main.ts","patch":[{"start1":158,"length1":92,"diffs":[[1,""]]}]},{"type":"edited","filename":"custom.ts","patch":[{"start1":269,"length1":33,"diffs":[[1," * Functions for Wifi8285 module.\n"]]},{"start1":400,"length1":44,"diffs":[[1,"    * Setup UART Wifi8285 to connect to Wifi\n"]]},{"start1":681,"length1":25,"diffs":[[1,"    //% ssid.defl=\"BBST1\"\n"]]},{"start1":1413,"length1":85,"diffs":[[1,"    //% block=\"Daten senden|Protokoll %protocol|IP %ip|Port %port|Text %message\"\n"]]},{"start1":1823,"length1":63,"diffs":[[1,"        sendAtCmd(`AT+CIPSTART=\"${protoStr}\",\"${ip}\",${port}`)\n"]]},{"start1":2003,"length1":54,"diffs":[[1,"            sendAtCmd(`AT+CIPSEND=${message.length}`)\n"]]}]}]},{"timestamp":1762429961935,"editorVersion":"8.1.5","changes":[{"type":"edited","filename":"main.blocks","patch":[{"start1":0,"length1":904,"diffs":[[1,"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables></variables><block type=\"device_forever\" x=\"0\" y=\"0\"><statement name=\"HANDLER\"><block type=\"UART_WiFi_V2_setupWifi\"><field name=\"txPin\">SerialPin.C17</field><field name=\"rxPin\">SerialPin.C16</field><field name=\"baudrate\">BaudRate.BaudRate115200</field><value name=\"ssid\"><shadow type=\"text\"><field name=\"TEXT\">BBST1</field></shadow></value><value name=\"passwd\"><shadow type=\"text\"><field name=\"TEXT\">123456789</field></shadow></value><next><block type=\"UART_WiFi_V2_sendData\"><field name=\"protocol\">Protocol.UDP</field><value name=\"ip\"><shadow type=\"text\"><field name=\"TEXT\">10.254.10.185</field></shadow></value><value name=\"port\"><shadow type=\"text\"><field name=\"TEXT\">69824</field></shadow></value><value name=\"message\"><shadow type=\"text\"><field name=\"TEXT\"></field></shadow></value></block></next></block></statement></block></xml>"]]}]}]},{"timestamp":1762430040889,"editorVersion":"8.1.5","changes":[{"type":"edited","filename":"main.blocks","patch":[{"start1":0,"length1":2253,"diffs":[[1,"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables></variables><block type=\"device_forever\" x=\"10\" y=\"10\"><statement name=\"HANDLER\"><block type=\"UART_WiFi_V2_setupWifi\"><field name=\"txPin\">SerialPin.C17</field><field name=\"rxPin\">SerialPin.C16</field><field name=\"baudrate\">BaudRate.BaudRate115200</field><value name=\"ssid\"><shadow type=\"text\"><field name=\"TEXT\">BBST1</field></shadow></value><value name=\"passwd\"><shadow type=\"text\"><field name=\"TEXT\">123456789</field></shadow></value><next><block type=\"UART_WiFi_V2_sendData\"><field name=\"protocol\">Protocol.UDP</field><value name=\"ip\"><shadow type=\"text\"><field name=\"TEXT\">10.254.10.185</field></shadow></value><value name=\"port\"><shadow type=\"text\"><field name=\"TEXT\">69824</field></shadow></value><value name=\"message\"><shadow type=\"text\"><field name=\"TEXT\"></field></shadow></value></block></next></block></statement></block></xml>"]]}]},{"type":"edited","filename":"main.ts","patch":[{"start1":123,"length1":12,"diffs":[[1,"    \"BBST1\",\n"]]},{"start1":158,"length1":0,"diffs":[[1,"    UART_WiFi_V2.sendData(\n    Protocol.UDP,\n    \"10.254.10.185\",\n    \"69824\",\n    \"\"\n    )\n"]]},{"start1":253,"length1":479,"diffs":[[1,""]]}]},{"type":"edited","filename":"custom.ts","patch":[{"start1":1140,"length1":52,"diffs":[[1,"        sendAtCmd(`AT+CWJAP=\"${ssid}\",\"${passwd}\"`)\n"]]},{"start1":1562,"length1":26,"diffs":[[1,"    //% port.defl=\"69824\"\n"]]}]}]},{"timestamp":1762430724469,"editorVersion":"8.1.5","changes":[{"type":"edited","filename":"custom.ts","patch":[{"start1":854,"length1":8,"diffs":[[1,"        let result = 0\n"]]}]}]},{"timestamp":1762430730510,"editorVersion":"8.1.5","changes":[{"type":"edited","filename":"main.blocks","patch":[{"start1":0,"length1":864,"diffs":[[1,"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables></variables><block type=\"device_forever\" x=\"53\" y=\"52\"><statement name=\"HANDLER\"><block type=\"UART_WiFi_V2_setupWifi\"><field name=\"txPin\">SerialPin.C17</field><field name=\"rxPin\">SerialPin.C16</field><field name=\"baudrate\">BaudRate.BaudRate115200</field><value name=\"ssid\"><shadow type=\"text\"><field name=\"TEXT\">r332</field></shadow></value><value name=\"passwd\"><shadow type=\"text\"><field name=\"TEXT\">123456789</field></shadow></value></block></statement></block><block type=\"device_forever\" x=\"372\" y=\"90\"><statement name=\"HANDLER\"><block type=\"controls_if\"><mutation else=\"1\"></mutation><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"UART_WiFi_V2_wifiOK\"></block></value><statement name=\"DO0\"><block type=\"device_show_leds\"><field name=\"LEDS\">`\n"]]}]},{"type":"edited","filename":"custom.ts","patch":[{"start1":469,"length1":26,"diffs":[[1,""]]},{"start1":854,"length1":24,"diffs":[[1,"       \n"]]},{"start1":894,"length1":9,"diffs":[[1,"\n"]]},{"start1":943,"length1":9,"diffs":[[1,"\n"]]},{"start1":1125,"length1":52,"diffs":[[1,"        sendAtCmd('AT+CWJAP=\"${ssid}\",\"${passwd}\"')\n"]]},{"start1":1395,"length1":26,"diffs":[[1,""]]},{"start1":1809,"length1":63,"diffs":[[1,"        sendAtCmd('AT+CIPSTART=\"${protoStr}\",\"${ip}\",${port}')\n"]]},{"start1":1989,"length1":56,"diffs":[[1,"            sendAtCmd('AT+CIPSEND=${message.length}')\n"]]},{"start1":2331,"length1":50,"diffs":[[1,"     * Check if UART Wifi8285 is connected to Wifi\n"]]},{"start1":2390,"length1":26,"diffs":[[1,"    //% weight=90\n"]]},{"start1":2433,"length1":31,"diffs":[[1,"    export function wifiOK(): boolean {\n"]]},{"start1":2511,"length1":382,"diffs":[[1,"    function waitAtResponse(target1: string, target2: string, target3: string, timeout: number): number {\n"]]}]}]},{"timestamp":1762431430294,"editorVersion":"8.1.5","changes":[{"type":"edited","filename":"custom.ts","patch":[{"start1":306,"length1":43,"diffs":[[1,"//% weight=10 color=#606060 icon=\"\\uf1eb\" block=\"Wifi8285\"\n"]]}]}]},{"timestamp":1762431460707,"editorVersion":"8.1.5","changes":[{"type":"edited","filename":"main.blocks","patch":[{"start1":0,"length1":866,"diffs":[[1,"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables></variables><block type=\"device_forever\" x=\"0\" y=\"0\"><statement name=\"HANDLER\"><block type=\"UART_WiFi_V2_setupWifi\"><field name=\"txPin\">SerialPin.C17</field><field name=\"rxPin\">SerialPin.C16</field><field name=\"baudrate\">BaudRate.BaudRate115200</field><value name=\"ssid\"><shadow type=\"text\"><field name=\"TEXT\">r332</field></shadow></value><value name=\"passwd\"><shadow type=\"text\"><field name=\"TEXT\">123456789</field></shadow></value></block></statement></block><block type=\"device_forever\" x=\"319\" y=\"38\"><statement name=\"HANDLER\"><block type=\"controls_if\"><mutation else=\"1\"></mutation><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"UART_WiFi_V2_wifiOK\"></block></value><statement name=\"DO0\"><block type=\"device_show_leds\"><field name=\"LEDS\">`\n"]]},{"start1":958,"length1":2176,"diffs":[[1,"        `</field><next><block type=\"device_pause\"><value name=\"pause\"><shadow type=\"timePicker\"><field name=\"ms\">1000</field></shadow></value><next><block type=\"UART_WiFi_V2_sendData\"><field name=\"protocol\">Protocol.UDP</field><value name=\"ip\"><shadow type=\"text\"><field name=\"TEXT\">10.254.10.185</field></shadow></value><value name=\"port\"><shadow type=\"text\"><field name=\"TEXT\">64289</field></shadow></value><value name=\"message\"><shadow type=\"text\"><field name=\"TEXT\">20</field></shadow></value><next><block type=\"basic_show_icon\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"0\" _input_init=\"true\"></mutation><field name=\"i\">IconNames.Yes</field><value name=\"interval\"><shadow type=\"math_number\"><field name=\"NUM\">600</field></shadow></value><next><block type=\"device_pause\"><value name=\"pause\"><shadow type=\"timePicker\"><field name=\"ms\">2000</field></shadow></value></block></next></block></next></block></next></block></next></block></statement><statement name=\"ELSE\"><block type=\"basic_show_icon\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"0\" _input_init=\"true\"></mutation><field name=\"i\">IconNames.Sad</field><value name=\"interval\"><shadow type=\"math_number\"><field name=\"NUM\">600</field></shadow></value></block></statement></block></statement></block></xml>"]]}]},{"type":"edited","filename":"main.ts","patch":[{"start1":636,"length1":118,"diffs":[[1,""]]}]},{"type":"edited","filename":"custom.ts","patch":[{"start1":306,"length1":42,"diffs":[[1,"//% weight=10 color=#606060 icon=\"\\uf1eb\" \n"]]},{"start1":383,"length1":53,"diffs":[[1,"    * Setup UART ESP8285 to connect to Wifi\n    */\n    //% weight=100\n"]]},{"start1":2863,"length1":105,"diffs":[[1,"    function waitAtResponse(target1: string, target2: string, target3: string, timeout: number) {\n"]]}]}]},{"timestamp":1762432019382,"editorVersion":"8.1.5","changes":[{"type":"edited","filename":"main.blocks","patch":[{"start1":0,"length1":2117,"diffs":[[1,"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables></variables><block type=\"device_forever\" x=\"33\" y=\"49\"><statement name=\"HANDLER\"><block type=\"UART_WiFi_V2_setupWifi\"><field name=\"txPin\">SerialPin.C17</field><field name=\"rxPin\">SerialPin.C16</field><field name=\"baudrate\">BaudRate.BaudRate115200</field><value name=\"ssid\"><shadow type=\"text\"><field name=\"TEXT\">r332</field></shadow></value><value name=\"passwd\"><shadow type=\"text\"><field name=\"TEXT\">123456789</field></shadow></value></block></statement></block><block type=\"device_forever\" x=\"319\" y=\"38\"><statement name=\"HANDLER\"><block type=\"controls_if\"><mutation else=\"1\"></mutation><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"UART_WiFi_V2_wifiOK\"></block></value><statement name=\"DO0\"><block type=\"device_show_leds\"><field name=\"LEDS\">`\n        # # # . . \n        . . . # . \n        # # . . # \n        . . # . # \n        . . # . #\n        `</field><next><block type=\"device_pause\"><value name=\"pause\"><shadow type=\"timePicker\"><field name=\"ms\">1000</field></shadow></value><next><block type=\"UART_WiFi_V2_sendData\"><field name=\"protocol\">Protocol.UDP</field><value name=\"ip\"><shadow type=\"text\"><field name=\"TEXT\">10.254.10.185</field></shadow></value><value name=\"port\"><shadow type=\"text\"><field name=\"TEXT\">64289</field></shadow></value><value name=\"message\"><shadow type=\"text\"><field name=\"TEXT\">20</field></shadow></value><next><block type=\"basic_show_icon\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"0\" _input_init=\"true\"></mutation><field name=\"i\">IconNames.Yes</field><value name=\"interval\"><shadow type=\"math_number\"><field name=\"NUM\">600</field></shadow></value><next><block type=\"device_pause\"><value name=\"pause\"><shadow type=\"timePicker\"><field name=\"ms\">2000</field></shadow></value></block></next></block></next></block></next></block></next></block></statement><statement name=\"ELSE\"><block type=\"basic_show_icon\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"0\" _input_init=\"true\"></mutation><field name=\"i\">IconNames.Sad</field><value name=\"interval\"><shadow type=\"math_number\"><field name=\"NUM\">600</field></shadow></value></block></statement><next><block type=\"device_show_number\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"0\" _input_init=\"true\"></mutation><value name=\"number\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"UART_WiFi_V2_waitAtResponse\"><value name=\"target1\"><shadow type=\"text\"><field name=\"TEXT\">t1</field></shadow></value><value name=\"target2\"><shadow type=\"text\"><field name=\"TEXT\">t2</field></shadow></value><value name=\"target3\"><shadow type=\"text\"><field name=\"TEXT\">t3</field></shadow></value><value name=\"timeout\"><shadow type=\"math_number\"><field name=\"NUM\">1000</field></shadow></value></block></value><value name=\"interval\"><shadow type=\"math_number\"><field name=\"NUM\">150</field></shadow></value><next><block type=\"device_pause\"><value name=\"pause\"><shadow type=\"timePicker\"><field name=\"ms\">1000</field></shadow></value></block></next></block></next></block></statement></block></xml>"]]}]},{"type":"edited","filename":"main.ts","patch":[{"start1":28,"length1":28,"diffs":[[1,"    UART_WiFi_V2.setupWifi(\n"]]},{"start1":188,"length1":218,"diffs":[[1,"    if (UART_WiFi_V2.wifiOK()) {\n        basic.showLeds(`\n            # # # . .\n            . . . # .\n            # # . . #\n            . . # . #\n            . . # . #\n            `)\n        basic.pause(1000)\n        UART_WiFi_V2.sendData(\n        Protocol.UDP,\n        \"10.254.10.185\",\n        \"64289\",\n        \"20\"\n        )\n        basic.showIcon(IconNames.Yes)\n        basic.pause(2000)\n    } else {\n        basic.showIcon(IconNames.Sad)\n"]]},{"start1":636,"length1":0,"diffs":[[1,"    basic.showNumber(UART_WiFi_V2.waitAtResponse(\n    \"t1\",\n    \"t2\",\n    \"t3\",\n    1000\n    ))\n"]]}]},{"type":"edited","filename":"custom.ts","patch":[{"start1":147,"length1":0,"diffs":[[1,"// Definiere ein numerisches Enum für das Protokoll\nenum Protocol {\n    UDP,\n    TCP\n}\n"]]},{"start1":235,"length1":0,"diffs":[[1,"let isWifiConnected = false;\n\n"]]},{"start1":269,"length1":24,"diffs":[[1," * Functions for ESP8285 module.\n"]]},{"start1":306,"length1":41,"diffs":[[1,"//% weight=10 color=#036fb6 icon=\"\\uf1eb\"\nnamespace UART_WiFi_V2 {\n"]]},{"start1":374,"length1":60,"diffs":[[1,""]]},{"start1":435,"length1":95,"diffs":[[1,""]]},{"start1":461,"length1":0,"diffs":[[1,"    //% block=\"setup Wifi|TX %txPin|RX %rxPin|baudrate %baudrate|ssid = %ssid|password = %passwd\"\n"]]},{"start1":671,"length1":0,"diffs":[[1,"    //% ssid.defl=\"r332\"\n    //% passwd.defl=\"123456789\"\n"]]},{"start1":902,"length1":96,"diffs":[[1,"        \n        serial.redirect(txPin, rxPin, baudRate)\n        \n"]]},{"start1":1351,"length1":1,"diffs":[[1,"    \n"]]},{"start1":1364,"length1":93,"diffs":[[1,"      * Send Data via Wifi\n      */\n    //% weight=100\n"]]},{"start1":1445,"length1":68,"diffs":[[1,"    //% block=\"Daten senden|Protokoll %protocol|Server %ip|Port %port|Text %message\"\n    //% protocol.defl=Protocol.UDP\n    //% ip.defl=\"10.254.10.185\"\n    //% port.defl=\"64289\"\n    //% message.defl=\"\"\n    export function sendData(protocol: Protocol, ip: string, port: string, message: string) {\n     \n        if (!isWifiConnected) return\n"]]},{"start1":1785,"length1":246,"diffs":[[1,"        let result = 0\n        let protoStr = protocolToString(protocol)\n"]]},{"start1":1859,"length1":298,"diffs":[[1,"        sendAtCmd(`AT+CIPSTART=\"${protoStr}\",\"${ip}\",${port}`)\n        result = waitAtResponse(\"OK\", \"ERROR\", \"ALREADY CONNECTED\", 5000)\n"]]},{"start1":1997,"length1":101,"diffs":[[1,"        if (result == 1 || result == 3) {\n            sendAtCmd(`\"AT+CIPSEND=\"${message.length}`)\n            result = waitAtResponse(\">\", \"ERROR\", \"SEND FAIL\", 3000)\n\n            if (result == 1) {\n                serial.writeString(message)\n                waitAtResponse(\"SEND OK\", \"ERROR\", \"SEND FAIL\", 3000)\n"]]},{"start1":2324,"length1":0,"diffs":[[1,"        }\n"]]},{"start1":2335,"length1":160,"diffs":[[1,"        sendAtCmd(\"AT+CIPCLOSE\")\n    }\n"]]},{"start1":2375,"length1":32,"diffs":[[1,"    /**\n     * Check if UART Wifi V2 is connected to Wifi\n     */\n    //% group=\"UART Wifi\"\n    //% block=\"Wifi OK?\"\n    export function wifiOK() {\n        return isWifiConnected\n"]]},{"start1":2561,"length1":2,"diffs":[[1,""]]},{"start1":2569,"length1":51,"diffs":[[1,"    * Wait AT response from UART Wifi V2\"\n"]]},{"start1":3334,"length1":1962,"diffs":[[1,"    function sendAtCmd(cmd: string) {\n        serial.writeString(cmd + \"\\u000D\\u000A\")\n"]]},{"start1":3428,"length1":2057,"diffs":[[1,"    function protocolToString(p: Protocol): string {\n        if (p == Protocol.UDP) return \"UDP\"\n        else return \"TCP\"\n"]]},{"start1":3557,"length1":1,"diffs":[[1,""]]}]},{"type":"edited","filename":"pxt.json","patch":[{"start1":220,"length1":35,"diffs":[[1,"    \"preferredEditor\": \"tsprj\"\n"]]}]}]},{"timestamp":1762432553668,"editorVersion":"8.1.5","changes":[{"type":"edited","filename":"main.blocks","patch":[{"start1":0,"length1":2442,"diffs":[[1,"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables></variables><block type=\"device_forever\" x=\"57\" y=\"50\"><statement name=\"HANDLER\"><block type=\"UART_Wifi_V2_setupWifi\"><field name=\"txPin\">SerialPin.C17</field><field name=\"rxPin\">SerialPin.C16</field><field name=\"baudrate\">BaudRate.BaudRate115200</field><value name=\"ssid\"><shadow type=\"text\"><field name=\"TEXT\">r332</field></shadow></value><value name=\"passwd\"><shadow type=\"text\"><field name=\"TEXT\">123456789</field></shadow></value></block></statement></block><block type=\"device_forever\" x=\"556\" y=\"124\"><statement name=\"HANDLER\"><block type=\"controls_if\"><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"UART_Wifi_V2_wifiOK\"></block></value><statement name=\"DO0\"><block type=\"basic_show_icon\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"0\" _input_init=\"true\"></mutation><field name=\"i\">IconNames.Heart</field><value name=\"interval\"><shadow type=\"math_number\"><field name=\"NUM\">600</field></shadow></value><next><block type=\"device_pause\"><value name=\"pause\"><shadow type=\"timePicker\"><field name=\"ms\">100</field></shadow></value><next><block type=\"device_show_number\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"0\" _input_init=\"true\"></mutation><value name=\"number\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"UART_Wifi_V2_waitAtResponse\"><value name=\"target1\"><shadow type=\"text\"><field name=\"TEXT\">t1</field></shadow></value><value name=\"target2\"><shadow type=\"text\"><field name=\"TEXT\">t2</field></shadow></value><value name=\"target3\"><shadow type=\"text\"><field name=\"TEXT\">t3</field></shadow></value><value name=\"timeout\"><shadow type=\"math_number\"><field name=\"NUM\">1000</field></shadow></value></block></value><value name=\"interval\"><shadow type=\"math_number\"><field name=\"NUM\">150</field></shadow></value></block></next></block></next></block></statement><next><block type=\"device_pause\"><value name=\"pause\"><shadow type=\"timePicker\"><field name=\"ms\">1000</field></shadow></value></block></next></block></statement></block></xml>"]]}]},{"type":"edited","filename":"main.ts","patch":[{"start1":221,"length1":116,"diffs":[[1,"        basic.showIcon(IconNames.Heart)\n        basic.pause(100)\n"]]},{"start1":406,"length1":25,"diffs":[[1,""]]},{"start1":412,"length1":0,"diffs":[[1,"    basic.pause(1000)\n"]]}]},{"type":"edited","filename":"pxt.json","patch":[{"start1":90,"length1":118,"diffs":[[1,"        \"v2\": \"*\"\n"]]}]},{"type":"edited","filename":"custom.ts","patch":[{"start1":0,"length1":1,"diffs":[[1,""]]},{"start1":147,"length1":73,"diffs":[[1,""]]},{"start1":152,"length1":17,"diffs":[[1," * Communication blocks\n"]]},{"start1":180,"length1":57,"diffs":[[1,"//% weight=5 color=#404040 icon=\"\\uf1eb\"\n\nnamespace UART_Wifi_V2 {\n\n    let isWifiConnected = false;\n\n"]]},{"start1":290,"length1":181,"diffs":[[1,"     * Setup UART Wifi V2 to connect to wifi\n"]]},{"start1":343,"length1":104,"diffs":[[1,"    //% block=\"Setup Wifi|TX %txPin RX %rxPin|Baud rate %baudrate|SSID %ssid|Password %passwd\"\n    //% group=\"UART Wifi\"\n    //% txPin.defl=SerialPin.C17\n    //% rxPin.defl=SerialPin.C16\n    //% baudRate.defl=BaudRate.BaudRate115200\n    export function setupWifi(txPin: SerialPin, rxPin: SerialPin, baudRate: BaudRate, ssid: string, passwd: string) {\n        let result = 0\n\n        isWifiConnected = false\n\n        serial.redirect(\n            txPin,\n            rxPin,\n            baudRate\n        )\n\n        sendAtCmd(\"AT\")\n        result = waitAtResponse(\"OK\", \"ERROR\", \"None\", 1000)\n\n        sendAtCmd(\"AT+CWMODE=1\")\n        result = waitAtResponse(\"OK\", \"ERROR\", \"None\", 1000)\n\n        sendAtCmd(`AT+CWJAP=\"${ssid}\",\"${passwd}\"`)\n        result = waitAtResponse(\"WIFI GOT IP\", \"ERROR\", \"None\", 20000)\n\n        if (result == 1) {\n            isWifiConnected = true\n        }\n"]]},{"start1":1238,"length1":88,"diffs":[[1,"     * Check if \"Grove - UART Wifi V2\" is connected to wifi\n"]]},{"start1":1306,"length1":131,"diffs":[[1,"    //% block=\"Wifi OK?\"\n    //% group=\"UART Wifi\"\n    export function wifiOK() {\n        return isWifiConnected\n"]]},{"start1":1425,"length1":2,"diffs":[[1,"\n    /**\n     * Send AT command to \"Grove - UART Wifi V2\"\n     */\n    //% block=\"send AT cmd %cmd\"\n    //% group=\"UART Wifi\"\n    //% cmd.defl=\"AT\"\n    export function sendAtCmd(cmd: string) {\n        serial.writeString(cmd + \"\\u000D\\u000A\")\n    }\n\n    /**\n      * Get ip address from \"Grove - UART Wifi V2\"\n      */\n    //% block=\"ip address\"\n    //% group=\"UART Wifi\"\n    export function ipaddress() {\n        let buffer = \"\"\n        let n = 0\n        if (isWifiConnected) {\n            sendAtCmd(\"AT+CIFSR\")\n            n = input.runningTime()\n\n            while ((input.runningTime() - n) < 2000) {\n                buffer += serial.readString()\n            }\n\n            n = buffer.indexOf('\"')\n            buffer = buffer.substr(n + 1, 100)\n            n = buffer.indexOf('\"')\n            buffer = buffer.substr(0, n)\n\n        }\n        return buffer\n    }\n\n\n\n    /**\n    * Wait AT response from \"Grove - UART Wifi V2\"\n    */\n    //% block=\"wait AT response|t1 %target1|t2 %target2|t3%target3|with %timeout milliseconds\"\n    //% group=\"UART Wifi\"\n    //% target1.defl=\"t1\"\n    //% target2.defl=\"t2\"\n    //% target3.defl=\"t3\"\n    //% timeout.defl=\"1000\"\n    export function waitAtResponse(target1: string, target2: string, target3: string, timeout: number) {\n        let buffer = \"\"\n        let start = input.runningTime()\n\n        while ((input.runningTime() - start) < timeout) {\n            buffer += serial.readString()\n\n            if (buffer.includes(target1)) return 1\n            if (buffer.includes(target2)) return 2\n            if (buffer.includes(target3)) return 3\n\n            basic.pause(100)\n        }\n\n        return 0\n    }\n\n    /**\n     * Send data to IFTTT\n     */\n    //% block=\"Send Data to your IFTTT Event|Event %event|Key %key|value1 %value1|value2 %value2|value3 %value3\"\n    //% group=\"UART Wifi\"\n    //% event.defl=\"your Event\"\n    //% key.defl=\"your Key\"\n    //% value1.defl=\"hello\"\n    //% value2.defl=\"micro\"\n    //% value3.defl=\"bit\"\n    export function sendToIFTTT(event: string, key: string, value1: string, value2: string, value3: string) {\n        let result = 0\n        let retry = 2\n\n        // close the previous TCP connection\n        if (isWifiConnected) {\n            sendAtCmd(\"AT+CIPCLOSE\")\n            waitAtResponse(\"OK\", \"ERROR\", \"None\", 2000)\n        }\n\n        while (isWifiConnected && retry > 0) {\n            retry = retry - 1;\n            // establish TCP connection\n            sendAtCmd(\"AT+CIPSTART=\\\"TCP\\\",\\\"maker.ifttt.com\\\",80\")\n            result = waitAtResponse(\"OK\", \"ALREADY CONNECTED\", \"ERROR\", 2000)\n            if (result == 3) continue\n\n            let data = \"GET /trigger/\" + event + \"/with/key/\" + key\n            data = data + \"?value1=\" + value1\n            data = data + \"&value2=\" + value2\n            data = data + \"&value3=\" + value3\n            data = data + \" HTTP/1.1\"\n            data = data + \"\\u000D\\u000A\"\n            data = data + \"User-Agent: curl/7.58.0\"\n            data = data + \"\\u000D\\u000A\"\n            data = data + \"Host: maker.ifttt.com\"\n            data = data + \"\\u000D\\u000A\"\n            data = data + \"Accept: */*\"\n            data = data + \"\\u000D\\u000A\"\n\n            sendAtCmd(\"AT+CIPSEND=\" + (data.length + 2))\n            result = waitAtResponse(\">\", \"OK\", \"ERROR\", 2000)\n            if (result == 3) continue\n            sendAtCmd(data)\n            result = waitAtResponse(\"SEND OK\", \"SEND FAIL\", \"ERROR\", 5000)\n\n            // // close the TCP connection\n            // sendAtCmd(\"AT+CIPCLOSE\")\n            // waitAtResponse(\"OK\", \"ERROR\", \"None\", 2000)\n\n            if (result == 1) break\n        }\n    }\n\n    /**\n     * Send data to ThinkSpeak\n     */\n    //% block=\"Send Data to your ThinkSpeak Channel|Write API Key %apiKey|Field1 %field1|Field2 %field2|Field3 %field3|Field4 %field4|Field5 %field5|Field6 %field6|Field7 %field7|Field8 %field8\"\n    //% group=\"UART Wifi\"\n    //% apiKey.defl=\"your Write API Key\"\n    export function sendToThinkSpeak(apiKey: string, field1: number, field2: number, field3: number, field4: number, field5: number, field6: number, field7: number, field8: number) {\n        let result = 0\n        let retry = 2\n\n        // close the previous TCP connection\n        if (isWifiConnected) {\n            sendAtCmd(\"AT+CIPCLOSE\")\n            waitAtResponse(\"OK\", \"ERROR\", \"None\", 2000)\n        }\n\n        while (isWifiConnected && retry > 0) {\n            retry = retry - 1;\n            // establish TCP connection\n            sendAtCmd(\"AT+CIPSTART=\\\"TCP\\\",\\\"api.thingspeak.com\\\",80\")\n            result = waitAtResponse(\"OK\", \"ALREADY CONNECTED\", \"ERROR\", 2000)\n            if (result == 3) continue\n\n            let data = \"GET /update?api_key=\" + apiKey\n            if (!isNaN(field1)) data = data + \"&field1=\" + field1\n            if (!isNaN(field2)) data = data + \"&field2=\" + field2\n            if (!isNaN(field3)) data = data + \"&field3=\" + field3\n            if (!isNaN(field4)) data = data + \"&field4=\" + field4\n            if (!isNaN(field5)) data = data + \"&field5=\" + field5\n            if (!isNaN(field6)) data = data + \"&field6=\" + field6\n            if (!isNaN(field7)) data = data + \"&field7=\" + field7\n            if (!isNaN(field8)) data = data + \"&field8=\" + field8\n\n            sendAtCmd(\"AT+CIPSEND=\" + (data.length + 2))\n            result = waitAtResponse(\">\", \"OK\", \"ERROR\", 2000)\n            if (result == 3) continue\n            sendAtCmd(data)\n            result = waitAtResponse(\"SEND OK\", \"SEND FAIL\", \"ERROR\", 5000)\n\n            // // close the TCP connection\n            // sendAtCmd(\"AT+CIPCLOSE\")\n            // waitAtResponse(\"OK\", \"ERROR\", \"None\", 2000)\n\n            if (result == 1) break\n        }\n    }\n\n}"]]}]}]},{"timestamp":1762433144421,"editorVersion":"8.1.5","changes":[{"type":"edited","filename":"main.blocks","patch":[{"start1":0,"length1":187,"diffs":[[1,"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables></variables><block type=\"device_forever\" x=\"56\" y=\"52\"><statement name=\"HANDLER\"><block type=\"UART_Wifi_V2_setupWifi\"><field name=\"txPin\">SerialPin.C17</field><field name=\"rxPin\">SerialPin.C16</field><field name=\"baudrate\">BaudRate.BaudRate115200</field><value name=\"ssid\"><shadow type=\"text\"><field name=\"TEXT\">r332</field></shadow></value><value name=\"passwd\"><shadow type=\"text\"><field name=\"TEXT\">123456789</field></shadow></value></block></statement></block><block type=\"device_forever\" x=\"372\" y=\"42\"><statement name=\"HANDLER\"><block type=\"controls_if\"><mutation else=\"1\"></mutation><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"UART_Wifi_V2_wifiOK\"></block></value><statement name=\"DO0\"><block type=\"basic_show_icon\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"0\" _input_init=\"true\"></mutation><field name=\"i\">IconNames.Happy</field><value name=\"interval\"><shadow type=\"math_number\"><field name=\"NUM\">600</field></shadow></value></block></statement><statement name=\"ELSE\"><block type=\"basic_show_icon\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"0\" _input_init=\"true\"></mutation><field name=\"i\">IconNames.Sad</field><value name=\"interval\"><shadow type=\"math_number\"><field name=\"NUM\">600</field></shadow></value><next><block type=\"device_pause\"><value name=\"pause\"><shadow type=\"timePicker\"><field name=\"ms\">500</field></shadow></value><next><block type=\"device_show_number\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"0\" _input_init=\"true\"></mutation><value name=\"number\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"UART_Wifi_V2_waitAtResponse\"><value name=\"target1\"><shadow type=\"text\"><field name=\"TEXT\">t1</field></shadow></value><value name=\"target2\"><shadow type=\"text\"><field name=\"TEXT\">t2</field></shadow></value><value name=\"target3\"><shadow type=\"text\"><field name=\"TEXT\">t3</field></shadow></value><value name=\"timeout\"><shadow type=\"math_number\"><field name=\"NUM\">1000</field></shadow></value></block></value><value name=\"interval\"><shadow type=\"math_number\"><field name=\"NUM\">150</field></shadow></value><next><block type=\"device_pause\"><value name=\"pause\"><shadow type=\"timePicker\"><field name=\"ms\">500</field></shadow></value></block></next></block></next></block></next></block></statement></block></statement></block></xml>"]]}]},{"type":"edited","filename":"main.ts","patch":[{"start1":28,"length1":2,"diffs":[[1,"    UART_Wifi_V2.setupWifi(\n    SerialPin.C17,\n    SerialPin.C16,\n    BaudRate.BaudRate115200,\n    \"r332\",\n    \"123456789\"\n    )\n"]]},{"start1":188,"length1":2,"diffs":[[1,"    if (UART_Wifi_V2.wifiOK()) {\n        basic.showIcon(IconNames.Happy)\n    } else {\n        basic.showIcon(IconNames.Sad)\n        basic.pause(500)\n        basic.showNumber(UART_Wifi_V2.waitAtResponse(\n        \"t1\",\n        \"t2\",\n        \"t3\",\n        1000\n        ))\n        basic.pause(500)\n    }\n"]]}]},{"type":"edited","filename":"pxt.json","patch":[{"start1":90,"length1":18,"diffs":[[1,"        \"v2\": \"*\",\n        \"UART Wifi V2\": \"github:ralf-krause/uart-wifi-v2#d5cb824f7423c0ef599ed6c6090dd31244897608\"\n"]]}]},{"type":"edited","filename":"custom.ts","patch":[{"start1":0,"length1":0,"diffs":[[1,"\n"]]},{"start1":148,"length1":85,"diffs":[[1,"enum MyEnum {\n    //% block=\"one\"\n    One,\n    //% block=\"two\"\n    Two\n"]]},{"start1":222,"length1":30,"diffs":[[1,""]]},{"start1":226,"length1":33,"diffs":[[1," * Custom blocks\n"]]},{"start1":247,"length1":68,"diffs":[[1,"//% weight=100 color=#0fbc11 icon=\"\"\nnamespace custom {\n"]]},{"start1":312,"length1":45,"diffs":[[1,"     * TODO: describe your function here\n     * @param n describe parameter here, eg: 5\n     * @param s describe parameter here, eg: \"Hello\"\n     * @param e describe parameter here\n"]]},{"start1":501,"length1":894,"diffs":[[1,"    //% block\n    export function foo(n: number, s: string, e: MyEnum): void {\n        // Add code here\n"]]},{"start1":620,"length1":1064,"diffs":[[1,"     * TODO: describe your function here\n     * @param value describe value here, eg: 5\n"]]},{"start1":716,"length1":113,"diffs":[[1,"    //% block\n    export function fib(value: number): number {\n        return value <= 1 ? value : fib(value -1) + fib(value - 2);\n"]]},{"start1":853,"length1":998,"diffs":[[1,"}\n"]]}]}]},{"timestamp":1762433643684,"editorVersion":"8.1.5","changes":[{"type":"edited","filename":"main.blocks","patch":[{"start1":0,"length1":184,"diffs":[[1,"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables></variables><block type=\"device_forever\" x=\"20\" y=\"20\"></block><block type=\"device_forever\" x=\"225\" y=\"20\"></block></xml>"]]}]}]},{"timestamp":1762441735405,"editorVersion":"8.1.5","changes":[{"type":"edited","filename":"pxt.json","patch":[{"start1":220,"length1":31,"diffs":[[1,"    \"preferredEditor\": \"blocksprj\"\n"]]}]}]},{"timestamp":1762441739059,"editorVersion":"8.1.5","changes":[{"type":"edited","filename":"main.blocks","patch":[{"start1":0,"length1":3194,"diffs":[[1,"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables></variables><block type=\"device_forever\" x=\"0\" y=\"0\"></block><block type=\"device_forever\" x=\"205\" y=\"0\"></block></xml>"]]}]},{"type":"edited","filename":"main.ts","patch":[{"start1":28,"length1":420,"diffs":[[1,"\t\n"]]},{"start1":61,"length1":139,"diffs":[[1,"\t\n"]]}]},{"type":"edited","filename":"pxt.json","patch":[{"start1":90,"length1":75,"diffs":[[1,"        \"v2\": \"*\"\n"]]},{"start1":220,"length1":35,"diffs":[[1,"    \"preferredEditor\": \"tsprj\"\n"]]}]}]},{"timestamp":1762442358088,"editorVersion":"8.1.5","changes":[{"type":"edited","filename":"pxt.json","patch":[{"start1":277,"length1":31,"diffs":[[1,"    \"preferredEditor\": \"blocksprj\"\n"]]}]}]},{"timestamp":1762442391424,"editorVersion":"8.1.5","changes":[{"type":"edited","filename":"main.blocks","patch":[{"start1":0,"length1":2902,"diffs":[[1,"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables></variables><block type=\"device_forever\" x=\"470\" y=\"-98\"><statement name=\"HANDLER\"><block type=\"controls_if\"><mutation else=\"1\"></mutation><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"UART_WiFi_V2_wifiOK\"></block></value><statement name=\"DO0\"><block type=\"basic_show_icon\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"0\" _input_init=\"true\"></mutation><field name=\"i\">IconNames.Happy</field><value name=\"interval\"><shadow type=\"math_number\"><field name=\"NUM\">600</field></shadow></value><next><block type=\"device_pause\"><value name=\"pause\"><shadow type=\"timePicker\"><field name=\"ms\">500</field></shadow></value><next><block type=\"device_show_number\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"0\" _input_init=\"true\"></mutation><value name=\"number\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"UART_WiFi_V2_waitAtResponse\"><value name=\"target1\"><shadow type=\"text\"><field name=\"TEXT\">t1</field></shadow></value><value name=\"target2\"><shadow type=\"text\"><field name=\"TEXT\">t2</field></shadow></value><value name=\"target3\"><shadow type=\"text\"><field name=\"TEXT\">t3</field></shadow></value><value name=\"timeout\"><shadow type=\"math_number\"><field name=\"NUM\">1000</field></shadow></value></block></value><value name=\"interval\"><shadow type=\"math_number\"><field name=\"NUM\">150</field></shadow></value></block></next></block></next></block></statement><statement name=\"ELSE\"><block type=\"basic_show_icon\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"0\" _input_init=\"true\"></mutation><field name=\"i\">IconNames.Sad</field><value name=\"interval\"><shadow type=\"math_number\"><field name=\"NUM\">600</field></shadow></value><next><block type=\"device_pause\"><value name=\"pause\"><shadow type=\"timePicker\"><field name=\"ms\">500</field></shadow></value><next><block type=\"device_show_number\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"0\" _input_init=\"true\"></mutation><value name=\"number\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"UART_WiFi_V2_waitAtResponse\"><value name=\"target1\"><shadow type=\"text\"><field name=\"TEXT\">t1</field></shadow></value><value name=\"target2\"><shadow type=\"text\"><field name=\"TEXT\">t2</field></shadow></value><value name=\"target3\"><shadow type=\"text\"><field name=\"TEXT\">t3</field></shadow></value><value name=\"timeout\"><shadow type=\"math_number\"><field name=\"NUM\">1000</field></shadow></value></block></value><value name=\"interval\"><shadow type=\"math_number\"><field name=\"NUM\">150</field></shadow></value></block></next></block></next></block></statement></block></statement></block><block type=\"device_forever\" x=\"0\" y=\"0\"><statement name=\"HANDLER\"><block type=\"UART_WiFi_V2_setupWifi\"><field name=\"txPin\">SerialPin.C17</field><field name=\"rxPin\">SerialPin.C16</field><field name=\"baudrate\">BaudRate.BaudRate115200</field><value name=\"ssid\"><shadow type=\"text\"><field name=\"TEXT\">ZIMBLMNN Gast</field></shadow></value><value name=\"passwd\"><shadow type=\"text\"><field name=\"TEXT\">M1!2013!M4</field></shadow></value></block></statement></block></xml>"]]}]},{"type":"edited","filename":"main.ts","patch":[{"start1":0,"length1":126,"diffs":[[1,""]]},{"start1":101,"length1":183,"diffs":[[1,"        basic.pause(500)\n        basic.showNumber(UART_WiFi_V2.waitAtResponse(\n        \"t1\",\n        \"t2\",\n        \"t3\",\n        1000\n        ))\n"]]},{"start1":448,"length1":22,"diffs":[[1,""]]},{"start1":451,"length1":0,"diffs":[[1,"basic.forever(function () {\n    UART_WiFi_V2.setupWifi(\n    SerialPin.C17,\n    SerialPin.C16,\n    BaudRate.BaudRate115200,\n    \"ZIMBLMNN Gast\",\n    \"M1!2013!M4\"\n    )\n})\n"]]}]},{"type":"edited","filename":"pxt.json","patch":[{"start1":90,"length1":18,"diffs":[[1,"        \"v2\": \"*\",\n        \"grove\": \"github:calliope-edu/pxt-grove#v0.9.5\"\n"]]},{"start1":277,"length1":35,"diffs":[[1,"    \"preferredEditor\": \"tsprj\"\n"]]}]}]},{"timestamp":1762442905599,"editorVersion":"8.1.5","changes":[{"type":"edited","filename":"main.blocks","patch":[{"start1":0,"length1":3353,"diffs":[[1,"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables></variables><block type=\"pxt-on-start\" x=\"-465\" y=\"17\"><statement name=\"HANDLER\"><block type=\"UART_WiFi_V2_setupWifi\"><field name=\"txPin\">SerialPin.C17</field><field name=\"rxPin\">SerialPin.C16</field><field name=\"baudrate\">BaudRate.BaudRate115200</field><value name=\"ssid\"><shadow type=\"text\"><field name=\"TEXT\">KurpfalzTEL-ZMBLMN</field></shadow></value><value name=\"passwd\"><shadow type=\"text\"><field name=\"TEXT\">97110488312162896182</field></shadow></value></block></statement></block><block type=\"device_forever\" x=\"17\" y=\"58\"><statement name=\"HANDLER\"><block type=\"controls_if\"><mutation else=\"1\"></mutation><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"UART_WiFi_V2_wifiOK\"></block></value><statement name=\"DO0\"><block type=\"basic_show_icon\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"0\" _input_init=\"true\"></mutation><field name=\"i\">IconNames.Happy</field><next><block type=\"UART_WiFi_V2_sendData\"><field name=\"protocol\">Protocol.UDP</field><value name=\"ip\"><shadow type=\"text\"><field name=\"TEXT\">192.168.178.174</field></shadow></value><value name=\"port\"><shadow type=\"text\"><field name=\"TEXT\">64289</field></shadow></value><value name=\"message\"><shadow type=\"text\"><field name=\"TEXT\">25</field></shadow></value><next><block type=\"device_pause\"><value name=\"pause\"><shadow type=\"timePicker\"><field name=\"ms\">100</field></shadow></value><next><block type=\"basic_show_icon\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"0\" _input_init=\"true\"></mutation><field name=\"i\">IconNames.Yes</field><value name=\"interval\"><shadow type=\"math_number\"><field name=\"NUM\">600</field></shadow></value></block></next></block></next></block></next></block></statement><statement name=\"ELSE\"><block type=\"basic_show_icon\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"0\" _input_init=\"true\"></mutation><field name=\"i\">IconNames.Sad</field><next><block type=\"device_pause\"><value name=\"pause\"><shadow type=\"timePicker\"><field name=\"ms\">500</field></shadow></value><next><block type=\"device_show_number\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"0\" _input_init=\"true\"></mutation><value name=\"number\"><block type=\"UART_WiFi_V2_waitAtResponse\"><value name=\"target1\"><shadow type=\"text\"><field name=\"TEXT\">t1</field></shadow></value><value name=\"target2\"><shadow type=\"text\"><field name=\"TEXT\">t2</field></shadow></value><value name=\"target3\"><shadow type=\"text\"><field name=\"TEXT\">t3</field></shadow></value><value name=\"timeout\"><shadow type=\"math_number\"><field name=\"NUM\">1000</field></shadow></value></block></value></block></next></block></next></block></statement><next><block type=\"device_pause\"><value name=\"pause\"><shadow type=\"timePicker\"><field name=\"ms\">2000</field></shadow></value></block></next></block></statement></block></xml>"]]}]},{"type":"edited","filename":"main.ts","patch":[{"start1":79,"length1":30,"diffs":[[1,"\"KurpfalzTEL-ZMBLMN\",\n\"97110488312162896182\"\n"]]},{"start1":280,"length1":25,"diffs":[[1,"        \"192.168.178.174\",\n"]]},{"start1":372,"length1":120,"diffs":[[1,"        basic.showIcon(IconNames.Yes)\n"]]}]},{"type":"edited","filename":"pxt.json","patch":[{"start1":220,"length1":31,"diffs":[[1,"    \"preferredEditor\": \"blocksprj\"\n"]]}]}]},{"timestamp":1762443483681,"editorVersion":"8.1.5","changes":[{"type":"edited","filename":"main.blocks","patch":[{"start1":0,"length1":3352,"diffs":[[1,"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables></variables><block type=\"pxt-on-start\" x=\"-465\" y=\"17\"><statement name=\"HANDLER\"><block type=\"UART_WiFi_V2_setupWifi\"><field name=\"txPin\">SerialPin.C17</field><field name=\"rxPin\">SerialPin.C16</field><field name=\"baudrate\">BaudRate.BaudRate115200</field><value name=\"ssid\"><shadow type=\"text\"><field name=\"TEXT\">ZIMBLMNN Gast</field></shadow></value><value name=\"passwd\"><shadow type=\"text\"><field name=\"TEXT\">M1!2013!M4</field></shadow></value></block></statement></block><block type=\"device_forever\" x=\"17\" y=\"58\"><statement name=\"HANDLER\"><block type=\"controls_if\"><mutation else=\"1\"></mutation><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"UART_WiFi_V2_wifiOK\"></block></value><statement name=\"DO0\"><block type=\"basic_show_icon\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"0\" _input_init=\"true\"></mutation><field name=\"i\">IconNames.Happy</field><next><block type=\"UART_WiFi_V2_sendData\"><field name=\"protocol\">Protocol.UDP</field><value name=\"ip\"><shadow type=\"text\"><field name=\"TEXT\">192.168.179.4</field></shadow></value><value name=\"port\"><shadow type=\"text\"><field name=\"TEXT\">64289</field></shadow></value><value name=\"message\"><shadow type=\"text\"><field name=\"TEXT\">25</field></shadow></value><next><block type=\"device_pause\"><value name=\"pause\"><shadow type=\"timePicker\"><field name=\"ms\">100</field></shadow></value><next><block type=\"device_show_number\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"0\" _input_init=\"true\"></mutation><value name=\"number\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"UART_WiFi_V2_waitAtResponse\"><value name=\"target1\"><shadow type=\"text\"><field name=\"TEXT\">t1</field></shadow></value><value name=\"target2\"><shadow type=\"text\"><field name=\"TEXT\">t2</field></shadow></value><value name=\"target3\"><shadow type=\"text\"><field name=\"TEXT\">t3</field></shadow></value><value name=\"timeout\"><shadow type=\"math_number\"><field name=\"NUM\">1000</field></shadow></value></block></value><value name=\"interval\"><shadow type=\"math_number\"><field name=\"NUM\">150</field></shadow></value></block></next></block></next></block></next></block></statement><statement name=\"ELSE\"><block type=\"basic_show_icon\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"0\" _input_init=\"true\"></mutation><field name=\"i\">IconNames.Sad</field><next><block type=\"device_pause\"><value name=\"pause\"><shadow type=\"timePicker\"><field name=\"ms\">500</field></shadow></value><next><block type=\"device_show_number\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"0\" _input_init=\"true\"></mutation><value name=\"number\"><block type=\"UART_WiFi_V2_waitAtResponse\"><value name=\"target1\"><shadow type=\"text\"><field name=\"TEXT\">t1</field></shadow></value><value name=\"target2\"><shadow type=\"text\"><field name=\"TEXT\">t2</field></shadow></value><value name=\"target3\"><shadow type=\"text\"><field name=\"TEXT\">t3</field></shadow></value><value name=\"timeout\"><shadow type=\"math_number\"><field name=\"NUM\">1000</field></shadow></value></block></value></block></next></block></next></block></statement><next><block type=\"device_pause\"><value name=\"pause\"><shadow type=\"timePicker\"><field name=\"ms\">2000</field></shadow></value></block></next></block></statement></block></xml>"]]}]},{"type":"edited","filename":"custom.ts","patch":[{"start1":1037,"length1":33,"diffs":[[1,""]]},{"start1":1132,"length1":41,"diffs":[[1,""]]},{"start1":1185,"length1":108,"diffs":[[1,"        result = waitAtResponse(\"WIFI GOT IP\", \"ERROR\", \"None\", 20000)\n\n        if (result == 1) {\n"]]},{"start1":1834,"length1":64,"diffs":[[1,"        sendAtCmd(`AT+CIPSTART=\"${protoStr}\",\"${ip}\",${port}`)\n"]]}]}]},{"timestamp":1762444040556,"editorVersion":"8.1.5","changes":[{"type":"edited","filename":"custom.ts","patch":[{"start1":1268,"length1":71,"diffs":[[1,"        result = waitAtResponse(\"WIFI GOT IP\", \"ERROR\", \"None\", 30000)\n"]]},{"start1":1917,"length1":138,"diffs":[[1,"        sendAtCmd(`\"AT+CIPSTART=\"${protoStr}\",\"${ip}\",${port}`)\n"]]},{"start1":2098,"length1":125,"diffs":[[1,"            sendAtCmd(`\"AT+CIPSEND=\"${message.length}`)\n"]]},{"start1":2394,"length1":33,"diffs":[[1,"        sendAtCmd(\"AT+CIPCLOSE\")\n"]]}]}]},{"timestamp":1762444603749,"editorVersion":"8.1.5","changes":[{"type":"edited","filename":"main.blocks","patch":[{"start1":0,"length1":3352,"diffs":[[1,"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables></variables><block type=\"pxt-on-start\" x=\"-482\" y=\"-41\"><statement name=\"HANDLER\"><block type=\"UART_WiFi_V2_setupWifi\"><field name=\"txPin\">SerialPin.C17</field><field name=\"rxPin\">SerialPin.C16</field><field name=\"baudrate\">BaudRate.BaudRate115200</field><value name=\"ssid\"><shadow type=\"text\"><field name=\"TEXT\">ZIMBLMNN Gast</field></shadow></value><value name=\"passwd\"><shadow type=\"text\"><field name=\"TEXT\">M1!2013!M4</field></shadow></value></block></statement></block><block type=\"device_forever\" x=\"0\" y=\"0\"><statement name=\"HANDLER\"><block type=\"controls_if\"><mutation else=\"1\"></mutation><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"UART_WiFi_V2_wifiOK\"></block></value><statement name=\"DO0\"><block type=\"basic_show_icon\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"0\" _input_init=\"true\"></mutation><field name=\"i\">IconNames.Happy</field><next><block type=\"UART_WiFi_V2_sendData\"><field name=\"protocol\">Protocol.UDP</field><value name=\"ip\"><shadow type=\"text\"><field name=\"TEXT\">192.168.179.4</field></shadow></value><value name=\"port\"><shadow type=\"text\"><field name=\"TEXT\">64289</field></shadow></value><value name=\"message\"><shadow type=\"text\"><field name=\"TEXT\">25</field></shadow></value><next><block type=\"device_pause\"><value name=\"pause\"><shadow type=\"timePicker\"><field name=\"ms\">100</field></shadow></value><next><block type=\"device_show_number\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"0\" _input_init=\"true\"></mutation><value name=\"number\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"UART_WiFi_V2_waitAtResponse\"><value name=\"target1\"><shadow type=\"text\"><field name=\"TEXT\">t1</field></shadow></value><value name=\"target2\"><shadow type=\"text\"><field name=\"TEXT\">t2</field></shadow></value><value name=\"target3\"><shadow type=\"text\"><field name=\"TEXT\">t3</field></shadow></value><value name=\"timeout\"><shadow type=\"math_number\"><field name=\"NUM\">1000</field></shadow></value></block></value><value name=\"interval\"><shadow type=\"math_number\"><field name=\"NUM\">150</field></shadow></value></block></next></block></next></block></next></block></statement><statement name=\"ELSE\"><block type=\"basic_show_icon\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"0\" _input_init=\"true\"></mutation><field name=\"i\">IconNames.Sad</field><next><block type=\"device_pause\"><value name=\"pause\"><shadow type=\"timePicker\"><field name=\"ms\">500</field></shadow></value><next><block type=\"device_show_number\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"0\" _input_init=\"true\"></mutation><value name=\"number\"><block type=\"UART_WiFi_V2_waitAtResponse\"><value name=\"target1\"><shadow type=\"text\"><field name=\"TEXT\">t1</field></shadow></value><value name=\"target2\"><shadow type=\"text\"><field name=\"TEXT\">t2</field></shadow></value><value name=\"target3\"><shadow type=\"text\"><field name=\"TEXT\">t3</field></shadow></value><value name=\"timeout\"><shadow type=\"math_number\"><field name=\"NUM\">1000</field></shadow></value></block></value></block></next></block></next></block></statement><next><block type=\"device_pause\"><value name=\"pause\"><shadow type=\"timePicker\"><field name=\"ms\">2000</field></shadow></value></block></next></block></statement></block></xml>"]]}]},{"type":"edited","filename":"main.ts","patch":[{"start1":330,"length1":25,"diffs":[[1,"        basic.pause(100)\n"]]}]},{"type":"edited","filename":"custom.ts","patch":[{"start1":2230,"length1":95,"diffs":[[1,"            sendAtCmd(`AT+CIPSEND=${message.length}`)\n"]]},{"start1":3536,"length1":102,"diffs":[[1,""]]},{"start1":3574,"length1":41,"diffs":[[1,"        serial.writeString(cmd + \"\\u000D\\u000A\")\n"]]},{"start1":3630,"length1":1,"diffs":[[1,""]]}]}]},{"timestamp":1762445395014,"editorVersion":"8.1.5","changes":[{"type":"edited","filename":"custom.ts","patch":[{"start1":2230,"length1":54,"diffs":[[1,"            //sendAtCmd(`AT+CIPSEND=${message.length}`)\n"]]}]}]},{"timestamp":1762445400351,"editorVersion":"8.1.5","changes":[{"type":"edited","filename":"custom.ts","patch":[{"start1":1419,"length1":13,"diffs":[[1,""]]},{"start1":1805,"length1":43,"diffs":[[1,""]]},{"start1":1917,"length1":146,"diffs":[[1,"        //sendAtCmd(`\"AT+CIPSTART=\"${protoStr}\",\"${ip}\",${port}`)\n        sendAtCmd(`AT+CIPSTART=\"${protoStr}\",\"${ip}\",${port}`)\n        \n        result = waitAtResponse(\"OK\", \"ERROR\", \"ALREADY CONNECTED\", 5000)\n"]]},{"start1":2172,"length1":58,"diffs":[[1,"            //sendAtCmd(`\"AT+CIPSEND=\"${message.length}`)\n            sendAtCmd(`AT+CIPSEND=${message.length}`)\n            sendAtCmd(`AT+CIPSEND=13`)\n            \n"]]},{"start1":2437,"length1":41,"diffs":[[1,"                serial.writeString(message)\n"]]},{"start1":2576,"length1":35,"diffs":[[1,"        sendAtCmd(`AT+CIPCLOSE`)\n"]]}]}]},{"timestamp":1762445996026,"editorVersion":"8.1.5","changes":[{"type":"edited","filename":"main.blocks","patch":[{"start1":0,"length1":84,"diffs":[[1,"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables></variables><block type=\"pxt-on-start\" x=\"-482\" y=\"-41\"><statement name=\"HANDLER\"><block type=\"UART_WiFi_V2_setupWifi\"><field name=\"txPin\">SerialPin.C17</field><field name=\"rxPin\">SerialPin.C16</field><field name=\"baudrate\">BaudRate.BaudRate115200</field><value name=\"ssid\"><shadow type=\"text\"><field name=\"TEXT\">ZIMBLMNN Gast</field></shadow></value><value name=\"passwd\"><shadow type=\"text\"><field name=\"TEXT\">M1!2013!M4</field></shadow></value></block></statement></block><block type=\"device_forever\" x=\"0\" y=\"0\"><statement name=\"HANDLER\"><block type=\"controls_if\"><mutation else=\"1\"></mutation><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"UART_WiFi_V2_wifiOK\"></block></value><statement name=\"DO0\"><block type=\"basic_show_icon\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"0\" _input_init=\"true\"></mutation><field name=\"i\">IconNames.Happy</field><next><block type=\"UART_WiFi_V2_sendData\"><field name=\"protocol\">Protocol.UDP</field><value name=\"ip\"><shadow type=\"text\"><field name=\"TEXT\">192.168.179.4</field></shadow></value><value name=\"port\"><shadow type=\"text\"><field name=\"TEXT\">64289</field></shadow></value><value name=\"message\"><shadow type=\"text\"><field name=\"TEXT\">25</field></shadow></value><next><block type=\"device_pause\"><value name=\"pause\"><shadow type=\"timePicker\"><field name=\"ms\">500</field></shadow></value><next><block type=\"device_show_number\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"0\" _input_init=\"true\"></mutation><value name=\"number\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"UART_WiFi_V2_waitAtResponse\"><value name=\"target1\"><shadow type=\"text\"><field name=\"TEXT\">t1</field></shadow></value><value name=\"target2\"><shadow type=\"text\"><field name=\"TEXT\">t2</field></shadow></value><value name=\"target3\"><shadow type=\"text\"><field name=\"TEXT\">t3</field></shadow></value><value name=\"timeout\"><shadow type=\"math_number\"><field name=\"NUM\">1000</field></shadow></value></block></value><value name=\"interval\"><shadow type=\"math_number\"><field name=\"NUM\">150</field></shadow></value></block></next></block></next></block></next></block></statement><statement name=\"ELSE\"><block type=\"basic_show_icon\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"0\" _input_init=\"true\"></mutation><field name=\"i\">IconNames.Sad</field><next><block type=\"device_pause\"><value name=\"pause\"><shadow type=\"timePicker\"><field name=\"ms\">500</field></shadow></value><next><block type=\"device_show_number\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"0\" _input_init=\"true\"></mutation><value name=\"number\"><block type=\"UART_WiFi_V2_waitAtResponse\"><value name=\"target1\"><shadow type=\"text\"><field name=\"TEXT\">t1</field></shadow></value><value name=\"target2\"><shadow type=\"text\"><field name=\"TEXT\">t2</field></shadow></value><value name=\"target3\"><shadow type=\"text\"><field name=\"TEXT\">t3</field></shadow></value><value name=\"timeout\"><shadow type=\"math_number\"><field name=\"NUM\">1000</field></shadow></value></block></value></block></next></block></next></block></statement><next><block type=\"device_pause\"><value name=\"pause\"><shadow type=\"timePicker\"><field name=\"ms\">2000</field></shadow></value></block></next></block></statement></block></xml>"]]}]},{"type":"edited","filename":"pxt.json","patch":[{"start1":220,"length1":44,"diffs":[[1,""]]}]},{"type":"edited","filename":"custom.ts","patch":[{"start1":1419,"length1":5,"diffs":[[1,"    let z=0;\n"]]},{"start1":1818,"length1":73,"diffs":[[1,"        if(z===0){\n            \n        }\n"]]},{"start1":1899,"length1":144,"diffs":[[1,"        let result = 0\n        let protoStr = protocolToString(protocol)\n"]]},{"start1":1973,"length1":70,"diffs":[[1,"        //sendAtCmd(`AT+CIPSTART=\"${protoStr}\",\"${ip}\",${port}`)       \n"]]},{"start1":2457,"length1":33,"diffs":[[1,"        //sendAtCmd(`AT+CIPCLOSE`)\n"]]}]},{"type":"added","filename":"test.ts","value":"// Hier kann man Tests durchführen; diese Datei wird nicht kompiliert, wenn dieses Paket als Erweiterung verwendet wird.\n"}]}],"snapshots":[{"timestamp":1762419155204,"editorVersion":"8.1.5","text":{"main.blocks":"<xml xmlns=\"http://www.w3.org/1999/xhtml\">\n  <block type=\"pxt-on-start\"></block>\n  <block type=\"device_forever\"></block>\n</xml>","main.ts":"\n","README.md":"","pxt.json":"{\n    \"name\": \"wifiV2\",\n    \"description\": \"\",\n    \"dependencies\": {\n        \"core\": \"*\"\n    },\n    \"files\": [\n        \"main.blocks\",\n        \"main.ts\",\n        \"README.md\"\n    ],\n    \"additionalFilePaths\": []\n}\n"}},{"timestamp":1762421050291,"editorVersion":"8.1.5","text":{"main.blocks":"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables></variables><block type=\"device_forever\" x=\"0\" y=\"0\"><statement name=\"HANDLER\"><block type=\"UART_WiFi_V2_setupWifi\"><field name=\"txPin\">SerialPin.C17</field><field name=\"rxPin\">SerialPin.C16</field><field name=\"baudrate\">BaudRate.BaudRate115200</field><value name=\"ssid\"><shadow type=\"text\"><field name=\"TEXT\">BBST1</field></shadow></value><value name=\"passwd\"><shadow type=\"text\"><field name=\"TEXT\">123456789</field></shadow></value><next><block type=\"UART_WiFi_V2_sendData\"><field name=\"rxPin\">SerialPin.C16</field><field name=\"baudrate\">BaudRate.BaudRate115200</field><value name=\"ssid\"><shadow type=\"text\"><field name=\"TEXT\">BBST1</field></shadow></value><value name=\"passwd\"><shadow type=\"text\"><field name=\"TEXT\">123456789</field></shadow></value></block></next></block></statement></block></xml>","main.ts":"basic.forever(function () {\n    UART_WiFi_V2.setupWifi(\n    SerialPin.C17,\n    SerialPin.C16,\n    BaudRate.BaudRate115200,\n    \"BBST1\",\n    \"123456789\"\n    )\n    UART_WiFi_V2.sendData(\n    \"\",\n    SerialPin.C16,\n    BaudRate.BaudRate115200,\n    \"BBST1\",\n    \"123456789\"\n    )\n})\n","README.md":"","custom.ts":"\n/**\n* Nutze diese Datei für benutzerdefinierte Funktionen und Blöcke.\n* Weitere Informationen unter https://makecode.calliope.cc/blocks/custom\n*/\n\nlet isWifiConnected = false;\n\n/**\n * Functions for Wifi8285 module.\n */\n//% weight=10 color=#606060 icon=\"\\uf1eb\" block=\"Wifi8285\"\n\nnamespace UART_WiFi_V2 {\n        /**\n        * Setup UART Wifi8285 to connect to  Wifi\n        */\n        //% weight=100\n        //% block=\"setup Wifi|TX %txPin|RX %rxPin|baudrate %baudrate|ssid = %ssid|password = %passwd\"\n        //% txPin.defl=SerialPin.C17\n        //% rxPin.defl=SerialPin.C16\n        //% baudRate.defl=BaudRate.BaudRate115200\n        //% ssid.defl=\"BBST1\"\n        //% passwd.defl=\"123456789\"\n        export function setupWifi(txPin: SerialPin, rxPin: SerialPin, baudRate: BaudRate, ssid: string, passwd: string) {\n        let result = 0;\n\n        isWifiConnected = false;\n\n        serial.redirect(\n            txPin,\n            rxPin,\n            baudRate\n        )\n\n        sendAtCmd(\"AT\")\n        result = waitAtResponse(\"OK\", \"ERROR\", \"None\", 1000)\n\n        sendAtCmd(\"AT+CWMODE=1\")\n        result = waitAtResponse(\"OK\", \"ERROR\", \"None\", 1000)\n\n        sendAtCmd(`AT+CWJAP=\"${ssid}\",\"${passwd}\"`)\n        result = waitAtResponse(\"WIFI GOT IP\", \"ERROR\", \"None\", 20000)\n\n        if (result == 1) {\n            isWifiConnected = true\n        }\n    }\n    \n    /**\n    * sendData\n    */\n    //% weight=100\n    //% block=\"Daten senden|protocol = %protocol |RX %rxPin|baudrate %baudrate|ssid = %ssid|password = %passwd\"\n    //% protocol.defl=\"UDP\"\n    //% rxPin.defl=SerialPin.C16\n    //% baudRate.defl=BaudRate.BaudRate115200\n    //% ssid.defl=\"BBST1\"\n    //% passwd.defl=\"123456789\"\n    export function sendData(protocol: string, rxPin: SerialPin, baudRate: BaudRate, ssid: string, passwd: string) {\n    \n    }\n\n\n\n\n\n\n    /**\n     * Check if UART Wifi8285 is connected to Wifi\n     */\n    //% weight=90\n    //% block=\"Wifi OK?\"\n    export function wifiOK() {\n        return isWifiConnected\n    }\n\n    function waitAtResponse(target1: string, target2: string, target3: string, timeout: number) {\n        let buffer = \"\"\n        let start = input.runningTime()\n\n        while ((input.runningTime() - start) < timeout) {\n            buffer += serial.readString()\n\n            if (buffer.includes(target1)) return 1\n            if (buffer.includes(target2)) return 2\n            if (buffer.includes(target3)) return 3\n\n            basic.pause(100)\n        }\n\n            return 0\n        }\n\n        function sendAtCmd(cmd: string) {\n            serial.writeString(cmd + \"\\u000D\\u000A\")\n        }\n    \n}\n","pxt.json":"{\n    \"name\": \"wifiV2\",\n    \"description\": \"\",\n    \"dependencies\": {\n        \"core\": \"*\",\n        \"v2\": \"*\"\n    },\n    \"files\": [\n        \"main.blocks\",\n        \"main.ts\",\n        \"README.md\",\n        \"custom.ts\"\n    ],\n    \"preferredEditor\": \"tsprj\"\n}\n"}},{"timestamp":1762422925992,"editorVersion":"8.1.5","text":{"main.blocks":"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables></variables><block type=\"device_forever\" x=\"0\" y=\"0\"><statement name=\"HANDLER\"><block type=\"UART_WiFi_V2_setupWifi\"><field name=\"txPin\">SerialPin.C17</field><field name=\"rxPin\">SerialPin.C16</field><field name=\"baudrate\">BaudRate.BaudRate115200</field><value name=\"ssid\"><shadow type=\"text\"><field name=\"TEXT\">BBST1</field></shadow></value><value name=\"passwd\"><shadow type=\"text\"><field name=\"TEXT\">123456789</field></shadow></value></block></statement></block></xml>","main.ts":"basic.forever(function () {\n    UART_WiFi_V2.setupWifi(\n    SerialPin.C17,\n    SerialPin.C16,\n    BaudRate.BaudRate115200,\n    \"BBST1\",\n    \"123456789\"\n    )\n})\n","README.md":"","custom.ts":"\n/**\n* Nutze diese Datei für benutzerdefinierte Funktionen und Blöcke.\n* Weitere Informationen unter https://makecode.calliope.cc/blocks/custom\n*/\n\n// Definiere ein Enum für das Protokoll\nenum Protocol {\n    UDP = \"UDP\",\n    TCP = \"TCP\"\n}\n\nlet isWifiConnected = false;\n\n/**\n * Functions for Wifi8285 module.\n */\n//% weight=10 color=#606060 icon=\"\\uf1eb\" block=\"Wifi8285\"\n\nnamespace UART_WiFi_V2 {\n        /**\n        * Setup UART Wifi8285 to connect to  Wifi\n        */\n        //% weight=100\n        //% block=\"setup Wifi|TX %txPin|RX %rxPin|baudrate %baudrate|ssid = %ssid|password = %passwd\"\n        //% txPin.defl=SerialPin.C17\n        //% rxPin.defl=SerialPin.C16\n        //% baudRate.defl=BaudRate.BaudRate115200\n        //% ssid.defl=\"BBST1\"\n        //% passwd.defl=\"123456789\"\n        export function setupWifi(txPin: SerialPin, rxPin: SerialPin, baudRate: BaudRate, ssid: string, passwd: string) {\n        let result = 0;\n\n        isWifiConnected = false;\n\n        serial.redirect(\n            txPin,\n            rxPin,\n            baudRate\n        )\n\n        sendAtCmd(\"AT\")\n        result = waitAtResponse(\"OK\", \"ERROR\", \"None\", 1000)\n\n        sendAtCmd(\"AT+CWMODE=1\")\n        result = waitAtResponse(\"OK\", \"ERROR\", \"None\", 1000)\n\n        sendAtCmd(`AT+CWJAP=\"${ssid}\",\"${passwd}\"`)\n        result = waitAtResponse(\"WIFI GOT IP\", \"ERROR\", \"None\", 20000)\n\n        if (result == 1) {\n            isWifiConnected = true\n        }\n    }\n    \n    /**\n    * sendData\n    */\n    //% weight=100\n    //% block=\"setup Wifi|Protokoll = %protocol|Port %port|Text = %message\"\n    //% protocol.defl=Protocol.UDP\n    //% port.defl=\"68492\"\n    //% message.defl=\"\"\n    export function sendData(protocol: Protocol, port: string, message: string) {\n\n    }\n\n\n\n\n\n\n    /**\n     * Check if UART Wifi8285 is connected to Wifi\n     */\n    //% weight=90\n    //% block=\"Wifi OK?\"\n    export function wifiOK() {\n        return isWifiConnected\n    }\n\n    function waitAtResponse(target1: string, target2: string, target3: string, timeout: number) {\n        let buffer = \"\"\n        let start = input.runningTime()\n\n        while ((input.runningTime() - start) < timeout) {\n            buffer += serial.readString()\n\n            if (buffer.includes(target1)) return 1\n            if (buffer.includes(target2)) return 2\n            if (buffer.includes(target3)) return 3\n\n            basic.pause(100)\n        }\n\n            return 0\n        }\n\n        function sendAtCmd(cmd: string) {\n            serial.writeString(cmd + \"\\u000D\\u000A\")\n        }\n    \n}\n","pxt.json":"{\n    \"name\": \"wifiV2\",\n    \"description\": \"\",\n    \"dependencies\": {\n        \"core\": \"*\",\n        \"v2\": \"*\"\n    },\n    \"files\": [\n        \"main.blocks\",\n        \"main.ts\",\n        \"README.md\",\n        \"custom.ts\"\n    ],\n    \"preferredEditor\": \"tsprj\"\n}\n"}},{"timestamp":1762423017124,"editorVersion":"8.1.5","text":{"main.blocks":"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables></variables><block type=\"device_forever\" x=\"0\" y=\"0\"></block></xml>","main.ts":"basic.forever(function () {\n\t\n})\n","README.md":"","custom.ts":"basic.forever(function () {\n    UART_WiFi_V2.setupWifi(\n    SerialPin.C17,\n    SerialPin.C16,\n    BaudRate.BaudRate115200,\n    \"BBST1\",\n    \"123456789\"\n    )\n\n})\n","pxt.json":"{\n    \"name\": \"wifiV2\",\n    \"description\": \"\",\n    \"dependencies\": {\n        \"core\": \"*\",\n        \"v2\": \"*\"\n    },\n    \"files\": [\n        \"main.blocks\",\n        \"main.ts\",\n        \"README.md\",\n        \"custom.ts\"\n    ],\n    \"preferredEditor\": \"tsprj\"\n}\n"}},{"timestamp":1762425325233,"editorVersion":"8.1.5","text":{"main.blocks":"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables></variables><block type=\"device_forever\" x=\"0\" y=\"0\"><statement name=\"HANDLER\"><block type=\"UART_WiFi_V2_setupWifi\"><field name=\"txPin\">SerialPin.C17</field><field name=\"rxPin\">SerialPin.C16</field><field name=\"baudrate\">BaudRate.BaudRate115200</field><value name=\"ssid\"><shadow type=\"text\"><field name=\"TEXT\">BBST1</field></shadow></value><value name=\"passwd\"><shadow type=\"text\"><field name=\"TEXT\">123456789</field></shadow></value></block></statement></block></xml>","main.ts":"","README.md":"","custom.ts":"\n/**\n* Nutze diese Datei für benutzerdefinierte Funktionen und Blöcke.\n* Weitere Informationen unter https://makecode.calliope.cc/blocks/custom\n*/\n\n// Definiere ein Enum für das Protokoll\nenum Protocol {\n    UDP = \"UDP\",\n    TCP = \"TCP\"\n}\n\nlet isWifiConnected = false;\n\n/**\n * Functions for Wifi8285 module.\n */\n//% weight=10 color=#606060 icon=\"\\uf1eb\" block=\"Wifi8285\"\n\nnamespace UART_WiFi_V2 {\n        /**\n        * Setup UART Wifi8285 to connect to  Wifi\n        */\n        //% weight=100\n        //% block=\"setup Wifi|TX %txPin|RX %rxPin|baudrate %baudrate|ssid = %ssid|password = %passwd\"\n        //% txPin.defl=SerialPin.C17\n        //% rxPin.defl=SerialPin.C16\n        //% baudRate.defl=BaudRate.BaudRate115200\n        //% ssid.defl=\"BBST1\"\n        //% passwd.defl=\"123456789\"\n        export function setupWifi(txPin: SerialPin, rxPin: SerialPin, baudRate: BaudRate, ssid: string, passwd: string) {\n        let result = 0;\n\n        isWifiConnected = false;\n\n        serial.redirect(\n            txPin,\n            rxPin,\n            baudRate\n        )\n\n        sendAtCmd(\"AT\")\n        result = waitAtResponse(\"OK\", \"ERROR\", \"None\", 1000)\n\n        sendAtCmd(\"AT+CWMODE=1\")\n        result = waitAtResponse(\"OK\", \"ERROR\", \"None\", 1000)\n\n        sendAtCmd(`AT+CWJAP=\"${ssid}\",\"${passwd}\"`)\n        result = waitAtResponse(\"WIFI GOT IP\", \"ERROR\", \"None\", 20000)\n\n        if (result == 1) {\n            isWifiConnected = true\n        }\n    }\n    \n    /**\n    * sendData\n    */\n    //% weight=100\n    //% block=\"Daten senden|Protokoll = %protocol|Port %port|Text = %message\"\n    //% protocol.defl=Protocol.UDP\n    //% port.defl=\"68492\"\n    //% message.defl=\"\"\n    export function sendData(protocol: Protocol, port: string, message: string) {\n\n    }\n\n\n\n\n\n\n    /**\n     * Check if UART Wifi8285 is connected to Wifi\n     */\n    //% weight=90\n    //% block=\"Wifi OK?\"\n    export function wifiOK() {\n        return isWifiConnected\n    }\n\n    function waitAtResponse(target1: string, target2: string, target3: string, timeout: number) {\n        let buffer = \"\"\n        let start = input.runningTime()\n\n        while ((input.runningTime() - start) < timeout) {\n            buffer += serial.readString()\n\n            if (buffer.includes(target1)) return 1\n            if (buffer.includes(target2)) return 2\n            if (buffer.includes(target3)) return 3\n\n            basic.pause(100)\n        }\n\n            return 0\n        }\n\n        function sendAtCmd(cmd: string) {\n            serial.writeString(cmd + \"\\u000D\\u000A\")\n        }\n    \n}\n","pxt.json":"{\n    \"name\": \"wifiV2\",\n    \"description\": \"\",\n    \"dependencies\": {\n        \"core\": \"*\",\n        \"v2\": \"*\"\n    },\n    \"files\": [\n        \"main.blocks\",\n        \"main.ts\",\n        \"README.md\",\n        \"custom.ts\"\n    ],\n    \"preferredEditor\": \"blocksprj\"\n}\n"}},{"timestamp":1762429961935,"editorVersion":"8.1.5","text":{"main.blocks":"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables></variables><block type=\"device_forever\" x=\"0\" y=\"0\"><statement name=\"HANDLER\"><block type=\"UART_WiFi_V2_setupWifi\"><field name=\"txPin\">SerialPin.C17</field><field name=\"rxPin\">SerialPin.C16</field><field name=\"baudrate\">BaudRate.BaudRate115200</field><value name=\"ssid\"><shadow type=\"text\"><field name=\"TEXT\">BBST1</field></shadow></value><value name=\"passwd\"><shadow type=\"text\"><field name=\"TEXT\">123456789</field></shadow></value><next><block type=\"UART_WiFi_V2_sendData\"><field name=\"protocol\">Protocol.TCP</field><value name=\"ip\"><shadow type=\"text\"><field name=\"TEXT\">10.254.10.185</field></shadow></value><value name=\"port\"><shadow type=\"text\"><field name=\"TEXT\">69824</field></shadow></value><value name=\"message\"><shadow type=\"text\"><field name=\"TEXT\"></field></shadow></value></block></next></block></statement></block></xml>","main.ts":"basic.forever(function () {\n    UART_WiFi_V2.setupWifi(\n    SerialPin.C17,\n    SerialPin.C16,\n    BaudRate.BaudRate115200,\n    \"BBST1\",\n    \"123456789\"\n    )\n})\n","README.md":"","custom.ts":"/**\n* Nutze diese Datei für benutzerdefinierte Funktionen und Blöcke.\n* Weitere Informationen unter https://makecode.calliope.cc/blocks/custom\n*/\n\n// Definiere ein numerisches Enum für das Protokoll\nenum Protocol {\n    UDP,\n    TCP\n}\n\nlet isWifiConnected = false;\n\n/**\n * Functions for Wifi8285 module.\n */\n//% weight=10 color=#606060 icon=\"\\uf1eb\" block=\"Wifi8285\"\nnamespace UART_WiFi_V2 {\n\n    /**\n    * Setup UART Wifi8285 to connect to Wifi\n    */\n    //% weight=100\n    //% block=\"setup Wifi|TX %txPin|RX %rxPin|baudrate %baudrate|ssid = %ssid|password = %passwd\"\n    //% txPin.defl=SerialPin.C17\n    //% rxPin.defl=SerialPin.C16\n    //% baudRate.defl=BaudRate.BaudRate115200\n    //% ssid.defl=\"BBST1\"\n    //% passwd.defl=\"123456789\"\n    export function setupWifi(txPin: SerialPin, rxPin: SerialPin, baudRate: BaudRate, ssid: string, passwd: string) {\n        let result = 0\n        isWifiConnected = false\n\n        serial.redirect(txPin, rxPin, baudRate)\n\n        sendAtCmd(\"AT\")\n        result = waitAtResponse(\"OK\", \"ERROR\", \"None\", 1000)\n\n        sendAtCmd(\"AT+CWMODE=1\")\n        result = waitAtResponse(\"OK\", \"ERROR\", \"None\", 1000)\n\n        sendAtCmd(`AT+CWJAP=\"${ssid}\",\"${passwd}\"`)\n        result = waitAtResponse(\"WIFI GOT IP\", \"ERROR\", \"None\", 20000)\n\n        if (result == 1) {\n            isWifiConnected = true\n        }\n    }\n    \n    /**\n      * Send Data via Wifi\n      */\n    //% weight=100\n    //% block=\"Daten senden|Protokoll %protocol|IP %ip|Port %port|Text %message\"\n    //% protocol.defl=Protocol.UDP\n    //% ip.defl=\"10.254.10.185\"\n    //% port.defl=\"69824\"\n    //% message.defl=\"\"\n    export function sendData(protocol: Protocol, ip: string, port: string, message: string) {\n     \n        if (!isWifiConnected) return\n\n        let result = 0\n        let protoStr = protocolToString(protocol)\n\n        sendAtCmd(`AT+CIPSTART=\"${protoStr}\",\"${ip}\",${port}`)\n        result = waitAtResponse(\"OK\", \"ERROR\", \"ALREADY CONNECTED\", 5000)\n\n        if (result == 1 || result == 3) {\n            sendAtCmd(`AT+CIPSEND=${message.length}`)\n            result = waitAtResponse(\">\", \"ERROR\", \"SEND FAIL\", 3000)\n\n            if (result == 1) {\n                serial.writeString(message)\n                waitAtResponse(\"SEND OK\", \"ERROR\", \"SEND FAIL\", 3000)\n            }\n        }\n\n        sendAtCmd(\"AT+CIPCLOSE\")\n    }\n\n    /**\n     * Check if UART Wifi8285 is connected to Wifi\n     */\n    //% weight=90\n    //% block=\"Wifi OK?\"\n    export function wifiOK(): boolean {\n        return isWifiConnected\n    }\n\n    function waitAtResponse(target1: string, target2: string, target3: string, timeout: number): number {\n        let buffer = \"\"\n        let start = input.runningTime()\n\n        while ((input.runningTime() - start) < timeout) {\n            buffer += serial.readString()\n\n            if (buffer.includes(target1)) return 1\n            if (buffer.includes(target2)) return 2\n            if (buffer.includes(target3)) return 3\n\n            basic.pause(100)\n        }\n\n        return 0\n    }\n\n    function sendAtCmd(cmd: string) {\n        serial.writeString(cmd + \"\\u000D\\u000A\")\n    }\n\n    function protocolToString(p: Protocol): string {\n        if (p == Protocol.UDP) return \"UDP\"\n        else return \"TCP\"\n    }\n}","pxt.json":"{\n    \"name\": \"wifiV2\",\n    \"description\": \"\",\n    \"dependencies\": {\n        \"core\": \"*\",\n        \"v2\": \"*\"\n    },\n    \"files\": [\n        \"main.blocks\",\n        \"main.ts\",\n        \"README.md\",\n        \"custom.ts\"\n    ],\n    \"preferredEditor\": \"tsprj\"\n}\n"}},{"timestamp":1762431917177,"editorVersion":"8.1.5","text":{"main.blocks":"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables></variables><block type=\"device_forever\" x=\"0\" y=\"0\"><statement name=\"HANDLER\"><block type=\"UART_WiFi_V2_setupWifi\"><field name=\"txPin\">SerialPin.C17</field><field name=\"rxPin\">SerialPin.C16</field><field name=\"baudrate\">BaudRate.BaudRate115200</field><value name=\"ssid\"><shadow type=\"text\"><field name=\"TEXT\">r332</field></shadow></value><value name=\"passwd\"><shadow type=\"text\"><field name=\"TEXT\">123456789</field></shadow></value></block></statement></block><block type=\"device_forever\" x=\"319\" y=\"38\"><statement name=\"HANDLER\"><block type=\"controls_if\"><mutation else=\"1\"></mutation><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"UART_WiFi_V2_wifiOK\"></block></value><statement name=\"DO0\"><block type=\"device_show_leds\"><field name=\"LEDS\">`\n        # # # . . \n        . . . # . \n        # # . . # \n        . . # . # \n        . . # . #\n        `</field><next><block type=\"device_pause\"><value name=\"pause\"><shadow type=\"timePicker\"><field name=\"ms\">1000</field></shadow></value><next><block type=\"UART_WiFi_V2_sendData\"><field name=\"protocol\">Protocol.UDP</field><value name=\"ip\"><shadow type=\"text\"><field name=\"TEXT\">10.254.10.185</field></shadow></value><value name=\"port\"><shadow type=\"text\"><field name=\"TEXT\">64289</field></shadow></value><value name=\"message\"><shadow type=\"text\"><field name=\"TEXT\">20</field></shadow></value><next><block type=\"basic_show_icon\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"0\" _input_init=\"true\"></mutation><field name=\"i\">IconNames.Yes</field><value name=\"interval\"><shadow type=\"math_number\"><field name=\"NUM\">600</field></shadow></value><next><block type=\"device_pause\"><value name=\"pause\"><shadow type=\"timePicker\"><field name=\"ms\">2000</field></shadow></value></block></next></block></next></block></next></block></next></block></statement><statement name=\"ELSE\"><block type=\"basic_show_icon\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"0\" _input_init=\"true\"></mutation><field name=\"i\">IconNames.Sad</field><value name=\"interval\"><shadow type=\"math_number\"><field name=\"NUM\">600</field></shadow></value></block></statement></block></statement></block></xml>","main.ts":"basic.forever(function () {\n    UART_WiFi_V2.setupWifi(\n    SerialPin.C17,\n    SerialPin.C16,\n    BaudRate.BaudRate115200,\n    \"r332\",\n    \"123456789\"\n    )\n})\nbasic.forever(function () {\n    if (UART_WiFi_V2.wifiOK()) {\n        basic.showLeds(`\n            # # # . .\n            . . . # .\n            # # . . #\n            . . # . #\n            . . # . #\n            `)\n        basic.pause(1000)\n        UART_WiFi_V2.sendData(\n        Protocol.UDP,\n        \"10.254.10.185\",\n        \"64289\",\n        \"20\"\n        )\n        basic.showIcon(IconNames.Yes)\n        basic.pause(2000)\n    } else {\n        basic.showIcon(IconNames.Sad)\n    }\n})\n","README.md":"","custom.ts":"/**\n* Nutze diese Datei für benutzerdefinierte Funktionen und Blöcke.\n* Weitere Informationen unter https://makecode.calliope.cc/blocks/custom\n*/\n\n// Definiere ein numerisches Enum für das Protokoll\nenum Protocol {\n    UDP,\n    TCP\n}\n\nlet isWifiConnected = false;\n\n/**\n * Functions for ESP8285 module.\n */\n//% weight=10 color=#036fb6 icon=\"\\uf1eb\"\nnamespace UART_WiFi_V2 {\n\n    /**\n     * Setup UART Wifi V2 to connect to wifi\n     */\n    //% group=\"UART Wifi\"\n    //% block=\"setup Wifi|TX %txPin|RX %rxPin|baudrate %baudrate|ssid = %ssid|password = %passwd\"\n    //% txPin.defl=SerialPin.C17\n    //% rxPin.defl=SerialPin.C16\n    //% baudRate.defl=BaudRate.BaudRate115200\n    //% ssid.defl=\"r332\"\n    //% passwd.defl=\"123456789\"\n    export function setupWifi(txPin: SerialPin, rxPin: SerialPin, baudRate: BaudRate, ssid: string, passwd: string) {\n        let result = 0\n\n        isWifiConnected = false\n        \n        serial.redirect(txPin, rxPin, baudRate)\n        \n        sendAtCmd(\"AT\")\n        result = waitAtResponse(\"OK\", \"ERROR\", \"None\", 1000)\n\n        sendAtCmd(\"AT+CWMODE=1\")\n        result = waitAtResponse(\"OK\", \"ERROR\", \"None\", 1000)\n\n        sendAtCmd(`AT+CWJAP=\"${ssid}\",\"${passwd}\"`)\n        result = waitAtResponse(\"WIFI GOT IP\", \"ERROR\", \"None\", 20000)\n\n        if (result == 1) {\n            isWifiConnected = true\n        }\n    }\n    \n    /**\n      * Send Data via Wifi\n      */\n    //% weight=100\n    //% group=\"UART Wifi\"\n    //% block=\"Daten senden|Protokoll %protocol|Server %ip|Port %port|Text %message\"\n    //% protocol.defl=Protocol.UDP\n    //% ip.defl=\"10.254.10.185\"\n    //% port.defl=\"64289\"\n    //% message.defl=\"\"\n    export function sendData(protocol: Protocol, ip: string, port: string, message: string) {\n     \n        if (!isWifiConnected) return\n\n        let result = 0\n        let protoStr = protocolToString(protocol)\n\n        sendAtCmd(`AT+CIPSTART=\"${protoStr}\",\"${ip}\",${port}`)\n        result = waitAtResponse(\"OK\", \"ERROR\", \"ALREADY CONNECTED\", 5000)\n\n        if (result == 1 || result == 3) {\n            sendAtCmd(`\"AT+CIPSEND=\"${message.length}`)\n            result = waitAtResponse(\">\", \"ERROR\", \"SEND FAIL\", 3000)\n\n            if (result == 1) {\n                serial.writeString(message)\n                waitAtResponse(\"SEND OK\", \"ERROR\", \"SEND FAIL\", 3000)\n            }\n        }\n\n        sendAtCmd(\"AT+CIPCLOSE\")\n    }\n\n    /**\n     * Check if UART Wifi V2 is connected to Wifi\n     */\n    //% group=\"UART Wifi\"\n    //% block=\"Wifi OK?\"\n    export function wifiOK() {\n        return isWifiConnected\n    }\n\n    /**\n    * Wait AT response from UART Wifi V2\"\n    */\n    //% block=\"wait AT response|t1 %target1|t2 %target2|t3%target3|with %timeout milliseconds\"\n    //% group=\"UART Wifi\"\n    //% target1.defl=\"t1\"\n    //% target2.defl=\"t2\"\n    //% target3.defl=\"t3\"\n    //% timeout.defl=\"1000\"\n    function waitAtResponse(target1: string, target2: string, target3: string, timeout: number) {\n        let buffer = \"\"\n        let start = input.runningTime()\n\n        while ((input.runningTime() - start) < timeout) {\n            buffer += serial.readString()\n\n            if (buffer.includes(target1)) return 1\n            if (buffer.includes(target2)) return 2\n            if (buffer.includes(target3)) return 3\n\n            basic.pause(100)\n        }\n\n        return 0\n    }\n\n    function sendAtCmd(cmd: string) {\n        serial.writeString(cmd + \"\\u000D\\u000A\")\n    }\n\n    function protocolToString(p: Protocol): string {\n        if (p == Protocol.UDP) return \"UDP\"\n        else return \"TCP\"\n    }\n}","pxt.json":"{\n    \"name\": \"wifiV2\",\n    \"description\": \"\",\n    \"dependencies\": {\n        \"core\": \"*\",\n        \"v2\": \"*\"\n    },\n    \"files\": [\n        \"main.blocks\",\n        \"main.ts\",\n        \"README.md\",\n        \"custom.ts\"\n    ],\n    \"preferredEditor\": \"tsprj\"\n}\n"}},{"timestamp":1762441735405,"editorVersion":"8.1.5","text":{"main.blocks":"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables></variables><block type=\"device_forever\" x=\"20\" y=\"20\"></block><block type=\"device_forever\" x=\"225\" y=\"20\"></block></xml>","main.ts":"","README.md":"","custom.ts":"/**\n* Nutze diese Datei für benutzerdefinierte Funktionen und Blöcke.\n* Weitere Informationen unter https://makecode.calliope.cc/blocks/custom\n*/\n\n// Definiere ein numerisches Enum für das Protokoll\nenum Protocol {\n    UDP,\n    TCP\n}\n\nlet isWifiConnected = false;\n\n/**\n * Functions for ESP8285 module.\n */\n//% weight=10 color=#036fb6 icon=\"\\uf1eb\"\nnamespace UART_WiFi_V2 {\n\n    /**\n     * Setup UART Wifi V2 to connect to wifi\n     */\n    //% group=\"UART Wifi\"\n    //% block=\"setup Wifi|TX %txPin|RX %rxPin|baudrate %baudrate|ssid = %ssid|password = %passwd\"\n    //% txPin.defl=SerialPin.C17\n    //% rxPin.defl=SerialPin.C16\n    //% baudRate.defl=BaudRate.BaudRate115200\n    //% ssid.defl=\"r332\"\n    //% passwd.defl=\"123456789\"\n    export function setupWifi(txPin: SerialPin, rxPin: SerialPin, baudRate: BaudRate, ssid: string, passwd: string) {\n        let result = 0\n\n        isWifiConnected = false\n\n        serial.redirect(txPin, rxPin, baudRate)\n\n        sendAtCmd(\"AT\")\n        result = waitAtResponse(\"OK\", \"ERROR\", \"None\", 1000)\n\n        sendAtCmd(\"AT+CWMODE=1\")\n        result = waitAtResponse(\"OK\", \"ERROR\", \"None\", 1000)\n\n        sendAtCmd(`AT+CWJAP=\"${ssid}\",\"${passwd}\"`)\n        result = waitAtResponse(\"WIFI GOT IP\", \"ERROR\", \"None\", 20000)\n\n        if (result == 1) {\n            isWifiConnected = true\n        }\n    }\n\n    /**\n      * Send Data via Wifi\n      */\n    //% weight=100\n    //% group=\"UART Wifi\"\n    //% block=\"Daten senden|Protokoll %protocol|Server %ip|Port %port|Text %message\"\n    //% protocol.defl=Protocol.UDP\n    //% ip.defl=\"10.254.10.185\"\n    //% port.defl=\"64289\"\n    //% message.defl=\"\"\n    export function sendData(protocol: Protocol, ip: string, port: string, message: string) {\n\n        if (!isWifiConnected) return\n\n        let result = 0\n        let protoStr = protocolToString(protocol)\n\n        sendAtCmd(`AT+CIPSTART=\"${protoStr}\",\"${ip}\",${port}`)\n        result = waitAtResponse(\"OK\", \"ERROR\", \"ALREADY CONNECTED\", 5000)\n\n        if (result == 1 || result == 3) {\n            sendAtCmd(`\"AT+CIPSEND=\"${message.length}`)\n            result = waitAtResponse(\">\", \"ERROR\", \"SEND FAIL\", 3000)\n\n            if (result == 1) {\n                serial.writeString(message)\n                waitAtResponse(\"SEND OK\", \"ERROR\", \"SEND FAIL\", 3000)\n            }\n        }\n\n        sendAtCmd(\"AT+CIPCLOSE\")\n    }\n\n    /**\n     * Check if UART Wifi V2 is connected to Wifi\n     */\n    //% group=\"UART Wifi\"\n    //% block=\"Wifi OK?\"\n    export function wifiOK() {\n        return isWifiConnected\n    }\n\n    /**\n    * Wait AT response from UART Wifi V2\"\n    */\n    //% block=\"wait AT response|t1 %target1|t2 %target2|t3%target3|with %timeout milliseconds\"\n    //% group=\"UART Wifi\"\n    //% target1.defl=\"t1\"\n    //% target2.defl=\"t2\"\n    //% target3.defl=\"t3\"\n    //% timeout.defl=\"1000\"\n    export function waitAtResponse(target1: string, target2: string, target3: string, timeout: number) {\n        let buffer = \"\"\n        let start = input.runningTime()\n\n        while ((input.runningTime() - start) < timeout) {\n            buffer += serial.readString()\n\n            if (buffer.includes(target1)) return 1\n            if (buffer.includes(target2)) return 2\n            if (buffer.includes(target3)) return 3\n\n            basic.pause(100)\n        }\n\n        return 0\n    }\n\n    function sendAtCmd(cmd: string) {\n        serial.writeString(cmd + \"\\u000D\\u000A\")\n    }\n\n    function protocolToString(p: Protocol): string {\n        if (p == Protocol.UDP) return \"UDP\"\n        else return \"TCP\"\n    }\n}","pxt.json":"{\n    \"name\": \"wifiV2\",\n    \"description\": \"\",\n    \"dependencies\": {\n        \"core\": \"*\",\n        \"v2\": \"*\"\n    },\n    \"files\": [\n        \"main.blocks\",\n        \"main.ts\",\n        \"README.md\",\n        \"custom.ts\"\n    ],\n    \"preferredEditor\": \"blocksprj\"\n}\n"}},{"timestamp":1762443666093,"editorVersion":"8.1.5","text":{"main.blocks":"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables></variables><block type=\"pxt-on-start\" x=\"-465\" y=\"17\"><statement name=\"HANDLER\"><block type=\"UART_WiFi_V2_setupWifi\"><field name=\"txPin\">SerialPin.C17</field><field name=\"rxPin\">SerialPin.C16</field><field name=\"baudrate\">BaudRate.BaudRate115200</field><value name=\"ssid\"><shadow type=\"text\"><field name=\"TEXT\">ZIMBLMNN Gast</field></shadow></value><value name=\"passwd\"><shadow type=\"text\"><field name=\"TEXT\">M1!2013!M4</field></shadow></value></block></statement></block><block type=\"device_forever\" x=\"17\" y=\"58\"><statement name=\"HANDLER\"><block type=\"controls_if\"><mutation else=\"1\"></mutation><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"UART_WiFi_V2_wifiOK\"></block></value><statement name=\"DO0\"><block type=\"basic_show_icon\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"0\" _input_init=\"true\"></mutation><field name=\"i\">IconNames.Happy</field><next><block type=\"UART_WiFi_V2_sendData\"><field name=\"protocol\">Protocol.UDP</field><value name=\"ip\"><shadow type=\"text\"><field name=\"TEXT\">192.168.179.4</field></shadow></value><value name=\"port\"><shadow type=\"text\"><field name=\"TEXT\">64289</field></shadow></value><value name=\"message\"><shadow type=\"text\"><field name=\"TEXT\">25</field></shadow></value><next><block type=\"device_pause\"><value name=\"pause\"><shadow type=\"timePicker\"><field name=\"ms\">100</field></shadow></value><next><block type=\"device_show_number\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"0\" _input_init=\"true\"></mutation><value name=\"number\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"UART_WiFi_V2_waitAtResponse\"><value name=\"target1\"><shadow type=\"text\"><field name=\"TEXT\">t1</field></shadow></value><value name=\"target2\"><shadow type=\"text\"><field name=\"TEXT\">t2</field></shadow></value><value name=\"target3\"><shadow type=\"text\"><field name=\"TEXT\">t3</field></shadow></value><value name=\"timeout\"><shadow type=\"math_number\"><field name=\"NUM\">1000</field></shadow></value></block></value><value name=\"interval\"><shadow type=\"math_number\"><field name=\"NUM\">150</field></shadow></value></block></next></block></next></block></next></block></statement><statement name=\"ELSE\"><block type=\"basic_show_icon\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"0\" _input_init=\"true\"></mutation><field name=\"i\">IconNames.Sad</field><next><block type=\"device_pause\"><value name=\"pause\"><shadow type=\"timePicker\"><field name=\"ms\">500</field></shadow></value><next><block type=\"device_show_number\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"0\" _input_init=\"true\"></mutation><value name=\"number\"><block type=\"UART_WiFi_V2_waitAtResponse\"><value name=\"target1\"><shadow type=\"text\"><field name=\"TEXT\">t1</field></shadow></value><value name=\"target2\"><shadow type=\"text\"><field name=\"TEXT\">t2</field></shadow></value><value name=\"target3\"><shadow type=\"text\"><field name=\"TEXT\">t3</field></shadow></value><value name=\"timeout\"><shadow type=\"math_number\"><field name=\"NUM\">1000</field></shadow></value></block></value></block></next></block></next></block></statement><next><block type=\"device_pause\"><value name=\"pause\"><shadow type=\"timePicker\"><field name=\"ms\">2000</field></shadow></value></block></next></block></statement></block></xml>","main.ts":"UART_WiFi_V2.setupWifi(\nSerialPin.C17,\nSerialPin.C16,\nBaudRate.BaudRate115200,\n\"ZIMBLMNN Gast\",\n\"M1!2013!M4\"\n)\nbasic.forever(function () {\n    if (UART_WiFi_V2.wifiOK()) {\n        basic.showIcon(IconNames.Happy)\n        UART_WiFi_V2.sendData(\n        Protocol.UDP,\n        \"192.168.179.4\",\n        \"64289\",\n        \"25\"\n        )\n        basic.pause(100)\n        basic.showNumber(UART_WiFi_V2.waitAtResponse(\n        \"t1\",\n        \"t2\",\n        \"t3\",\n        1000\n        ))\n    } else {\n        basic.showIcon(IconNames.Sad)\n        basic.pause(500)\n        basic.showNumber(UART_WiFi_V2.waitAtResponse(\n        \"t1\",\n        \"t2\",\n        \"t3\",\n        1000\n        ))\n    }\n    basic.pause(2000)\n})\n","README.md":"","custom.ts":"/**\n* Nutze diese Datei für benutzerdefinierte Funktionen und Blöcke.\n* Weitere Informationen unter https://makecode.calliope.cc/blocks/custom\n*/\n\n// Definiere ein numerisches Enum für das Protokoll\nenum Protocol {\n    UDP,\n    TCP\n}\n\nlet isWifiConnected = false;\n\n/**\n * Functions for ESP8285 module.\n */\n//% weight=10 color=#036fb6 icon=\"\\uf1eb\"\nnamespace UART_WiFi_V2 {\n\n    /**\n     * Setup UART Wifi V2 to connect to wifi\n     */\n    //% group=\"UART Wifi\"\n    //% block=\"setup Wifi|TX %txPin|RX %rxPin|baudrate %baudrate|ssid = %ssid|password = %passwd\"\n    //% txPin.defl=SerialPin.C17\n    //% rxPin.defl=SerialPin.C16\n    //% baudRate.defl=BaudRate.BaudRate115200\n    //% ssid.defl=\"r332\"\n    //% passwd.defl=\"123456789\"\n    export function setupWifi(txPin: SerialPin, rxPin: SerialPin, baudRate: BaudRate, ssid: string, passwd: string) {\n        let result = 0\n\n        isWifiConnected = false\n\n        serial.redirect(txPin, rxPin, baudRate)\n\n        sendAtCmd(\"AT\")\n        result = waitAtResponse(\"OK\", \"ERROR\", \"None\", 1000)\n\n        sendAtCmd(\"AT+CWMODE=1\")\n        result = waitAtResponse(\"OK\", \"ERROR\", \"None\", 1000)\n\n        sendAtCmd(`AT+CWJAP=\"${ssid}\",\"${passwd}\"`)\n        result = waitAtResponse(\"WIFI GOT IP\", \"ERROR\", \"None\", 20000)\n\n        if (result == 1) {\n            isWifiConnected = true\n        }\n    }\n\n    /**\n      * Send Data via Wifi\n      */\n    //% weight=100\n    //% group=\"UART Wifi\"\n    //% block=\"Daten senden|Protokoll %protocol|Server %ip|Port %port|Text %message\"\n    //% protocol.defl=Protocol.UDP\n    //% ip.defl=\"10.254.10.185\"\n    //% port.defl=\"64289\"\n    //% message.defl=\"\"\n    export function sendData(protocol: Protocol, ip: string, port: string, message: string) {\n\n        if (!isWifiConnected) return\n\n        let result = 0\n        let protoStr = protocolToString(protocol)\n\n        sendAtCmd(`AT+CIPSTART=\"${protoStr}\",\"${ip}\",${port}`)\n        result = waitAtResponse(\"OK\", \"ERROR\", \"ALREADY CONNECTED\", 5000)\n\n        if (result == 1 || result == 3) {\n            sendAtCmd(`\"AT+CIPSEND=\"${message.length}`)\n            result = waitAtResponse(\">\", \"ERROR\", \"SEND FAIL\", 3000)\n\n            if (result == 1) {\n                serial.writeString(message)\n                waitAtResponse(\"SEND OK\", \"ERROR\", \"SEND FAIL\", 3000)\n            }\n        }\n\n        sendAtCmd(\"AT+CIPCLOSE\")\n    }\n\n    /**\n     * Check if UART Wifi V2 is connected to Wifi\n     */\n    //% group=\"UART Wifi\"\n    //% block=\"Wifi OK?\"\n    export function wifiOK() {\n        return isWifiConnected\n    }\n\n    /**\n    * Wait AT response from UART Wifi V2\"\n    */\n    //% block=\"wait AT response|t1 %target1|t2 %target2|t3%target3|with %timeout milliseconds\"\n    //% group=\"UART Wifi\"\n    //% target1.defl=\"t1\"\n    //% target2.defl=\"t2\"\n    //% target3.defl=\"t3\"\n    //% timeout.defl=\"1000\"\n    export function waitAtResponse(target1: string, target2: string, target3: string, timeout: number) {\n        let buffer = \"\"\n        let start = input.runningTime()\n\n        while ((input.runningTime() - start) < timeout) {\n            buffer += serial.readString()\n\n            if (buffer.includes(target1)) return 1\n            if (buffer.includes(target2)) return 2\n            if (buffer.includes(target3)) return 3\n\n            basic.pause(100)\n        }\n\n        return 0\n    }\n\n    function sendAtCmd(cmd: string) {\n        serial.writeString(cmd + \"\\u000D\\u000A\")\n    }\n\n    function protocolToString(p: Protocol): string {\n        if (p == Protocol.UDP) return \"UDP\"\n        else return \"TCP\"\n    }\n}","pxt.json":"{\n    \"name\": \"wifiV2\",\n    \"description\": \"\",\n    \"dependencies\": {\n        \"core\": \"*\",\n        \"v2\": \"*\"\n    },\n    \"files\": [\n        \"main.blocks\",\n        \"main.ts\",\n        \"README.md\",\n        \"custom.ts\"\n    ],\n    \"preferredEditor\": \"tsprj\"\n}\n"}},{"timestamp":1762445719257,"editorVersion":"8.1.5","text":{"main.blocks":"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables></variables><block type=\"pxt-on-start\" x=\"-482\" y=\"-41\"><statement name=\"HANDLER\"><block type=\"UART_WiFi_V2_setupWifi\"><field name=\"txPin\">SerialPin.C17</field><field name=\"rxPin\">SerialPin.C16</field><field name=\"baudrate\">BaudRate.BaudRate115200</field><value name=\"ssid\"><shadow type=\"text\"><field name=\"TEXT\">ZIMBLMNN Gast</field></shadow></value><value name=\"passwd\"><shadow type=\"text\"><field name=\"TEXT\">M1!2013!M4</field></shadow></value></block></statement></block><block type=\"device_forever\" x=\"0\" y=\"0\"><statement name=\"HANDLER\"><block type=\"controls_if\"><mutation else=\"1\"></mutation><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"UART_WiFi_V2_wifiOK\"></block></value><statement name=\"DO0\"><block type=\"basic_show_icon\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"0\" _input_init=\"true\"></mutation><field name=\"i\">IconNames.Happy</field><next><block type=\"UART_WiFi_V2_sendData\"><field name=\"protocol\">Protocol.UDP</field><value name=\"ip\"><shadow type=\"text\"><field name=\"TEXT\">192.168.179.4</field></shadow></value><value name=\"port\"><shadow type=\"text\"><field name=\"TEXT\">64289</field></shadow></value><value name=\"message\"><shadow type=\"text\"><field name=\"TEXT\">25</field></shadow></value><next><block type=\"device_pause\"><value name=\"pause\"><shadow type=\"timePicker\"><field name=\"ms\">500</field></shadow></value><next><block type=\"device_show_number\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"0\" _input_init=\"true\"></mutation><value name=\"number\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"UART_WiFi_V2_waitAtResponse\"><value name=\"target1\"><shadow type=\"text\"><field name=\"TEXT\">t1</field></shadow></value><value name=\"target2\"><shadow type=\"text\"><field name=\"TEXT\">t2</field></shadow></value><value name=\"target3\"><shadow type=\"text\"><field name=\"TEXT\">t3</field></shadow></value><value name=\"timeout\"><shadow type=\"math_number\"><field name=\"NUM\">1000</field></shadow></value></block></value><value name=\"interval\"><shadow type=\"math_number\"><field name=\"NUM\">150</field></shadow></value></block></next></block></next></block></next></block></statement><statement name=\"ELSE\"><block type=\"basic_show_icon\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"0\" _input_init=\"true\"></mutation><field name=\"i\">IconNames.Sad</field><next><block type=\"device_pause\"><value name=\"pause\"><shadow type=\"timePicker\"><field name=\"ms\">500</field></shadow></value><next><block type=\"device_show_number\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" _expanded=\"0\" _input_init=\"true\"></mutation><value name=\"number\"><block type=\"UART_WiFi_V2_waitAtResponse\"><value name=\"target1\"><shadow type=\"text\"><field name=\"TEXT\">t1</field></shadow></value><value name=\"target2\"><shadow type=\"text\"><field name=\"TEXT\">t2</field></shadow></value><value name=\"target3\"><shadow type=\"text\"><field name=\"TEXT\">t3</field></shadow></value><value name=\"timeout\"><shadow type=\"math_number\"><field name=\"NUM\">1000</field></shadow></value></block></value></block></next></block></next></block></statement><next><block type=\"device_pause\"><value name=\"pause\"><shadow type=\"timePicker\"><field name=\"ms\">2000</field></shadow></value></block></next></block></statement></block></xml>","main.ts":"UART_WiFi_V2.setupWifi(\nSerialPin.C17,\nSerialPin.C16,\nBaudRate.BaudRate115200,\n\"ZIMBLMNN Gast\",\n\"M1!2013!M4\"\n)\nbasic.forever(function () {\n    if (UART_WiFi_V2.wifiOK()) {\n        basic.showIcon(IconNames.Happy)\n        UART_WiFi_V2.sendData(\n        Protocol.UDP,\n        \"192.168.179.4\",\n        \"64289\",\n        \"25\"\n        )\n        basic.pause(500)\n        basic.showNumber(UART_WiFi_V2.waitAtResponse(\n        \"t1\",\n        \"t2\",\n        \"t3\",\n        1000\n        ))\n    } else {\n        basic.showIcon(IconNames.Sad)\n        basic.pause(500)\n        basic.showNumber(UART_WiFi_V2.waitAtResponse(\n        \"t1\",\n        \"t2\",\n        \"t3\",\n        1000\n        ))\n    }\n    basic.pause(2000)\n})\n","README.md":"","custom.ts":"/**\n* Nutze diese Datei für benutzerdefinierte Funktionen und Blöcke.\n* Weitere Informationen unter https://makecode.calliope.cc/blocks/custom\n*/\n\n// Definiere ein numerisches Enum für das Protokoll\nenum Protocol {\n    UDP,\n    TCP\n}\n\nlet isWifiConnected = false;\n\n/**\n * Functions for ESP8285 module.\n */\n//% weight=10 color=#036fb6 icon=\"\\uf1eb\"\nnamespace UART_WiFi_V2 {\n\n    /**\n     * Setup UART Wifi V2 to connect to wifi\n     */\n    //% group=\"UART Wifi\"\n    //% block=\"setup Wifi|TX %txPin|RX %rxPin|baudrate %baudrate|ssid = %ssid|password = %passwd\"\n    //% txPin.defl=SerialPin.C17\n    //% rxPin.defl=SerialPin.C16\n    //% baudRate.defl=BaudRate.BaudRate115200\n    //% ssid.defl=\"r332\"\n    //% passwd.defl=\"123456789\"\n    export function setupWifi(txPin: SerialPin, rxPin: SerialPin, baudRate: BaudRate, ssid: string, passwd: string) {\n        let result = 0\n\n        isWifiConnected = false\n\n        serial.redirect(txPin, rxPin, baudRate)\n\n        sendAtCmd(\"AT\")\n        result = waitAtResponse(\"OK\", \"ERROR\", \"None\", 1000)\n        if (result !== 1) return\n\n        sendAtCmd(\"AT+CWMODE=1\")\n        result = waitAtResponse(\"OK\", \"ERROR\", \"None\", 1000)\n                if (result !== 1) return\n\n        sendAtCmd(`AT+CWJAP=\"${ssid}\",\"${passwd}\"`)\n        \n        result = waitAtResponse(\"WIFI GOT IP\", \"ERROR\", \"None\", 20000)\n        if (result === 1) {\n            isWifiConnected = true\n        }\n    }\n\n    /**\n      * Send Data via Wifi\n      */\n    //% weight=100\n    //% group=\"UART Wifi\"\n    //% block=\"Daten senden|Protokoll %protocol|Server %ip|Port %port|Text %message\"\n    //% protocol.defl=Protocol.UDP\n    //% ip.defl=\"10.254.10.185\"\n    //% port.defl=\"64289\"\n    //% message.defl=\"\"\n    export function sendData(protocol: Protocol, ip: string, port: string, message: string) {\n\n        if (!isWifiConnected) return\n\n        let result = 0\n        let protoStr = protocolToString(protocol)\n\n        //sendAtCmd(`\"AT+CIPSTART=\"${protoStr}\",\"${ip}\",${port}`)\n        sendAtCmd(`AT+CIPSTART=\"${protoStr}\",\"${ip}\",${port}`)\n        \n        result = waitAtResponse(\"OK\", \"ERROR\", \"ALREADY CONNECTED\", 5000)\n\n        if (result == 1 || result == 3) {\n            //sendAtCmd(`\"AT+CIPSEND=\"${message.length}`)\n            sendAtCmd(`AT+CIPSEND=${message.length}`)\n                    \n            result = waitAtResponse(\">\", \"ERROR\", \"SEND FAIL\", 3000)\n\n            if (result == 1) {\n                serial.writeString(\"25\")\n                waitAtResponse(\"SEND OK\", \"ERROR\", \"SEND FAIL\", 3000)\n            }\n        }\n\n        sendAtCmd(`AT+CIPCLOSE`)\n    }\n\n    /**\n     * Check if UART Wifi V2 is connected to Wifi\n     */\n    //% group=\"UART Wifi\"\n    //% block=\"Wifi OK?\"\n    export function wifiOK() {\n        return isWifiConnected\n    }\n\n    /**\n    * Wait AT response from UART Wifi V2\"\n    */\n    //% block=\"wait AT response|t1 %target1|t2 %target2|t3%target3|with %timeout milliseconds\"\n    //% group=\"UART Wifi\"\n    //% target1.defl=\"t1\"\n    //% target2.defl=\"t2\"\n    //% target3.defl=\"t3\"\n    //% timeout.defl=\"1000\"\n    export function waitAtResponse(target1: string, target2: string, target3: string, timeout: number) {\n        let buffer = \"\"\n        let start = input.runningTime()\n\n        while ((input.runningTime() - start) < timeout) {\n            buffer += serial.readString()\n\n            if (buffer.includes(target1)) return 1\n            if (buffer.includes(target2)) return 2\n            if (buffer.includes(target3)) return 3\n\n            basic.pause(100)\n        }\n\n        return 0\n    }\n\n    /*function sendAtCmd(cmd: string) {\n        serial.writeString(cmd + \"\\u000D\\u000A\")\n    }*/\n    \n    function sendAtCmd(cmd: string) {\n        serial.writeString(cmd + \"\\r\\n\")\n    }\n\n\n    function protocolToString(p: Protocol): string {\n        if (p == Protocol.UDP) return \"UDP\"\n        else return \"TCP\"\n    }\n}","pxt.json":"{\n    \"name\": \"wifiV2\",\n    \"description\": \"\",\n    \"dependencies\": {\n        \"core\": \"*\",\n        \"v2\": \"*\"\n    },\n    \"files\": [\n        \"main.blocks\",\n        \"main.ts\",\n        \"README.md\",\n        \"custom.ts\"\n    ],\n    \"preferredEditor\": \"tsprj\"\n}\n"}}],"shares":[],"lastSaveTime":1762446385817}